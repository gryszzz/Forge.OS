const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PerfChart-BE1lSwBm.js","./charts-vendor-BhZkIRjM.js","./IntelligencePanel-M1Mohq5u.js","./TreasuryPanel-CxY1bMju.js"])))=>i.map(i=>d[i]);
var Nn=Object.defineProperty;var kn=(e,n,o)=>n in e?Nn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o;var tt=(e,n,o)=>kn(e,typeof n!="symbol"?n+"":n,o);import{r as p,a as In,R as Jt}from"./charts-vendor-BhZkIRjM.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const m of r)if(m.type==="childList")for(const d of m.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function o(r){const m={};return r.integrity&&(m.integrity=r.integrity),r.referrerPolicy&&(m.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?m.credentials="include":r.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function i(r){if(r.ep)return;r.ep=!0;const m=o(r);fetch(r.href,m)}})();var Zt={exports:{}},Xe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rn=p,Cn=Symbol.for("react.element"),wn=Symbol.for("react.fragment"),Ln=Object.prototype.hasOwnProperty,On=Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Dn={key:!0,ref:!0,__self:!0,__source:!0};function en(e,n,o){var i,r={},m=null,d=null;o!==void 0&&(m=""+o),n.key!==void 0&&(m=""+n.key),n.ref!==void 0&&(d=n.ref);for(i in n)Ln.call(n,i)&&!Dn.hasOwnProperty(i)&&(r[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps,n)r[i]===void 0&&(r[i]=n[i]);return{$$typeof:Cn,type:e,key:m,ref:d,props:r,_owner:On.current}}Xe.Fragment=wn;Xe.jsx=en;Xe.jsxs=en;Zt.exports=Xe;var t=Zt.exports,ct={},Kt=In;ct.createRoot=Kt.createRoot,ct.hydrateRoot=Kt.hydrateRoot;const Ee=[{id:"mainnet",label:"Kaspa Mainnet",aliases:["mainnet","kaspa_mainnet","kaspa-mainnet","mainnet-11","mainnet11"],addressPrefixes:["kaspa"]},{id:"testnet-10",label:"Kaspa Testnet 10",aliases:["testnet","testnet10","testnet-10","tn10","kaspa_testnet_10","kaspa-testnet-10"],addressPrefixes:["kaspatest"]},{id:"testnet-11",label:"Kaspa Testnet 11",aliases:["testnet11","testnet-11","tn11","kaspa_testnet_11","kaspa-testnet-11"],addressPrefixes:["kaspatest"]},{id:"testnet-12",label:"Kaspa Testnet 12",aliases:["testnet12","testnet-12","tn12","kaspa_testnet_12","kaspa-testnet-12"],addressPrefixes:["kaspatest"]},{id:"devnet",label:"Kaspa Devnet",aliases:["devnet","kaspadev","kaspa_devnet","kaspa-devnet"],addressPrefixes:["kaspadev"]},{id:"simnet",label:"Kaspa Simnet",aliases:["simnet","kaspasim","kaspa_simnet","kaspa-simnet"],addressPrefixes:["kaspasim"]}],Mn=Ee;function Ut(e){return String(e||"").trim().toLowerCase().replace(/_/g,"-")}function Kn(e){const n=Ut(String(e??""));if(!n)return null;const o=Ee.find(i=>i.aliases.some(r=>Ut(r)===n));return o||(["livenet","live","main","0"].includes(n)?Ee[0]:["test","testnet","test-net","tn","1"].includes(n)?Ee[1]:["2","tn11"].includes(n)?Ee[2]:["3","tn12"].includes(n)?Ee[3]:null)}function dt(e){return Kn(e||"mainnet")||Ee[0]}const xt=(e,n=4)=>parseFloat(e||0).toFixed(n),tn=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),lo=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),te=e=>e?`${e.slice(0,18)}...${e.slice(-6)}`:"â€”",uo=(e,n,o)=>Math.min(o,Math.max(n,e)),nn=()=>Math.random().toString(36).slice(2,10),Un=/^[qpzry9x8gf2tvdw0s3jn54khce6mua7l]+$/i,sn=["kaspa","kaspatest","kaspadev","kaspasim"],ie=(e,n=sn)=>{const o=String(e||"").trim().toLowerCase(),i=o.indexOf(":");if(i<=0||i===o.length-1)return!1;const r=o.slice(0,i),m=o.slice(i+1);return!n.map(d=>d.toLowerCase()).includes(r)||m.length<61||m.length>63?!1:Un.test(m)},oe=(e,n=sn)=>{const o=String(e||"").trim();if(!ie(o,n))throw new Error(`Invalid Kaspa address for allowed prefixes: ${n.join(", ")}`);const i=o.toLowerCase(),r=i.indexOf(":"),m=i.slice(0,r),d=i.slice(r+1);return`${m}:${d}`},$n={},j=$n;function Pn(){if(typeof window>"u")return"";const e=new URLSearchParams(window.location.search).get("network");if(e)return e;try{return window.localStorage.getItem("forgeos.network")||""}catch{return""}}const on=Pn(),zn=on||j.VITE_KAS_NETWORK||"mainnet",Ue=dt(zn),z=Ue.id,Te=z.startsWith("testnet"),J=on?Ue.label:j.VITE_KAS_NETWORK_LABEL||Ue.label,K=Ue.addressPrefixes;function Bn(e){return String(e||"").split(",").map(n=>n.trim()).filter(Boolean)}function gt(e){return String(e||"").trim().replace(/\/+$/,"")}function He(e,n,o){return String((Te?n:e)||o||"").trim()}const Fn=He(j.VITE_KAS_API_MAINNET,j.VITE_KAS_API_TESTNET,j.VITE_KAS_API),qe=gt(Fn||(Te?"https://api-tn10.kaspa.org":"https://api.kaspa.org")),Wn=He(j.VITE_KAS_API_FALLBACKS_MAINNET,j.VITE_KAS_API_FALLBACKS_TESTNET,j.VITE_KAS_API_FALLBACKS),rn=Bn(Wn).map(e=>gt(e)).filter(e=>e&&e!==qe),Gn=He(j.VITE_KAS_EXPLORER_MAINNET,j.VITE_KAS_EXPLORER_TESTNET,j.VITE_KAS_EXPLORER),ve=gt(Gn||(Te?"https://explorer-tn10.kaspa.org":"https://explorer.kaspa.org")),ge=He(j.VITE_KAS_WS_URL_MAINNET,j.VITE_KAS_WS_URL_TESTNET,j.VITE_KAS_WS_URL),ze=j.VITE_KASPIUM_DEEP_LINK_SCHEME||"kaspium://",Vn=String(j.VITE_KAS_ENFORCE_WALLET_NETWORK||"true").toLowerCase()!=="false",nt=String(j.VITE_ACCUMULATE_ONLY||"true").toLowerCase()!=="false",$t=[qe,...rn].map(e=>String(e||"").trim()).filter(Boolean),Yn=new Set($t).size!==$t.length;if(Yn)throw new Error("Duplicate Kaspa API endpoints detected in VITE_KAS_API* configuration.");function je(e,n,o){try{return oe(e,n)}catch{throw new Error(`Invalid ${o}. Expected prefixes: ${n.join(", ")}`)}}const Xn=j.VITE_TREASURY_ADDRESS_MAINNET||"kaspa:qpv7fcvdlz6th4hqjtm9qkkms2dw0raem963x3hm8glu3kjgj7922vy69hv85",Hn=j.VITE_TREASURY_ADDRESS_TESTNET||"kaspatest:qpqz2vxj23kvh0m73ta2jjn2u4cv4tlufqns2eap8mxyyt0rvrxy6ejkful67",ht=je(Xn,["kaspa"],"VITE_TREASURY_ADDRESS_MAINNET"),Et=je(Hn,["kaspatest"],"VITE_TREASURY_ADDRESS_TESTNET"),qn=j.VITE_ACCUMULATION_ADDRESS_MAINNET||ht,Qn=j.VITE_ACCUMULATION_ADDRESS_TESTNET||Et,Jn=je(qn,["kaspa"],"VITE_ACCUMULATION_ADDRESS_MAINNET"),Zn=je(Qn,["kaspatest"],"VITE_ACCUMULATION_ADDRESS_TESTNET"),es=j.VITE_DEMO_ADDRESS_MAINNET||ht,ts=j.VITE_DEMO_ADDRESS_TESTNET||Et,ns=je(es,["kaspa"],"VITE_DEMO_ADDRESS_MAINNET"),ss=je(ts,["kaspatest"],"VITE_DEMO_ADDRESS_TESTNET"),os=Te?ss:ns,Pt=Te?Et:ht,Ge=Te?Zn:Jn,ee=Number(j.VITE_FEE_RATE||.2),ae=Number(j.VITE_TREASURY_SPLIT||.3),lt=Number((1-ae).toFixed(2)),Me=.5,Ke=2e-4,zt=.75,_e=Number(j.VITE_FREE_CYCLES_PER_DAY||30),Ve=String(j.VITE_BILLING_UPGRADE_URL||"").trim(),Bt=String(j.VITE_BILLING_CONTACT||"").trim(),Ye=Number(j.VITE_AUTO_CYCLE_SECONDS||120),st=String(j.VITE_LIVE_EXECUTION_DEFAULT||"false").toLowerCase()==="true";if(!Number.isFinite(ee)||ee<0)throw new Error("Invalid VITE_FEE_RATE. Expected a non-negative numeric value.");if(!Number.isFinite(ae)||ae<0||ae>1)throw new Error("Invalid VITE_TREASURY_SPLIT. Expected a value between 0 and 1.");if(!Number.isFinite(_e)||_e<1)throw new Error("Invalid VITE_FREE_CYCLES_PER_DAY. Expected an integer >= 1.");if(!Number.isFinite(Ye)||Ye<15)throw new Error("Invalid VITE_AUTO_CYCLE_SECONDS. Expected a numeric value >= 15.");const s={s1:"#0B1118",s2:"#101923",s3:"#16222F",border:"#213043",muted:"#32435A",accent:"#39DDB6",aLow:"#112C2A",text:"#EAF1F8",dim:"#8FA0B5",danger:"#FF5D7A",dLow:"#311520",warn:"#F7B267",wLow:"#322515",ok:"#4ADE80",oLow:"#11261A",purple:"#8F7BFF",shadow:"0 18px 45px rgba(0,0,0,0.38)"},c={fontFamily:"'IBM Plex Mono','SFMono-Regular',Menlo,Monaco,monospace"};function rs(e){return Math.floor(Number(e||0)*1e8)}function is(e){const n=Number((e==null?void 0:e.total)??(e==null?void 0:e.confirmed)??(e==null?void 0:e.balance)??0);return Number.isFinite(n)?xt(n/1e8,4):"0.0000"}function as(e){return typeof e=="string"?e:(e==null?void 0:e.txid)||(e==null?void 0:e.hash)||(e==null?void 0:e.transactionId)||""}function Ft(e){return/^[a-fA-F0-9]{64}$/.test(String(e||"").trim())}const ce={detect(){const e=typeof window<"u"?window.kasware:void 0;return{kasware:!!e,kaspium:!0,kaswareMethods:e?{requestAccounts:typeof e.requestAccounts=="function",getNetwork:typeof e.getNetwork=="function",getBalance:typeof e.getBalance=="function",signMessage:typeof e.signMessage=="function",sendKaspa:typeof e.sendKaspa=="function"}:null}},async connectKasware(){const e=window.kasware;if(!e)throw new Error("Kasware extension not detected. Install from kasware.org");if(typeof e.requestAccounts!="function")throw new Error("Kasware provider missing requestAccounts()");const n=await e.requestAccounts();if(!(n!=null&&n.length))throw new Error("No accounts returned from Kasware");const o=oe(n[0],K),i=typeof e.getNetwork=="function"?await e.getNetwork():z,r=dt(i),m=dt(z);if(Vn&&r.id!==m.id)throw new Error(`Kasware is on ${r.label}. Expected ${J}. Switch network in wallet and retry.`);return{address:o,network:r.id,provider:"kasware"}},connectKaspium(e){return{address:oe(e,K),network:z,provider:"kaspium"}},async getKaswareBalance(){const e=window.kasware;if(!e)throw new Error("Kasware not connected");if(typeof e.getBalance!="function")throw new Error("Kasware provider missing getBalance()");const n=await e.getBalance();return is(n)},async sendKasware(e,n){const o=window.kasware;if(!o)throw new Error("Kasware not connected");if(!(Number(n)>0))throw new Error("Amount must be greater than zero");const i=oe(e,K),r=rs(n);let m;if(typeof o.sendKaspa=="function")m=await o.sendKaspa(i,r);else if(typeof o.sendKAS=="function")m=await o.sendKAS(i,r);else throw new Error("Kasware provider missing sendKaspa()/sendKAS()");const d=as(m);if(!d||!Ft(d))throw new Error("Kasware did not return a transaction id");return d},async sendKaspium(e,n,o){const i=oe(e,K);if(!(Number(n)>0))throw new Error("Amount must be greater than zero");if(typeof window>"u")throw new Error("Kaspium deep-link is only available in browser environments");const r=encodeURIComponent(String(n)),m=o?encodeURIComponent(o):"",d=`${i}?amount=${r}${o?`&message=${m}`:""}`;let l=d;ze.toLowerCase().startsWith("kaspa")||(l=`${ze.endsWith("://")?ze:`${ze}://`}send?address=${encodeURIComponent(i)}&amount=${r}${o?`&note=${m}`:""}`),window.location.href=l;const u=window.prompt(`Complete transfer in Kaspium and paste txid.
Deep link:
${l}

Fallback URI:
${d}`);if(!u)throw new Error("Transaction not confirmed. No txid provided.");if(!Ft(u))throw new Error("Invalid txid format. Expected a 64-char hex transaction id.");return u.trim()},async signMessageKasware(e){const n=window.kasware;if(!n)throw new Error("Kasware not connected");if(typeof n.signMessage!="function"&&typeof n.signData!="function")throw new Error("Kasware provider missing signMessage/signData");return typeof n.signMessage=="function"?n.signMessage(e):n.signData(e)}},N=({children:e,p:n=16,style:o={}})=>t.jsx("div",{style:{background:`linear-gradient(165deg, ${s.s2} 0%, #0a1725 52%, ${s.s1} 100%)`,border:`1px solid ${s.border}cc`,borderRadius:14,padding:n,boxShadow:`${s.shadow}, inset 0 1px 0 rgba(255,255,255,0.04)`,backdropFilter:"blur(6px)",transition:"border-color 0.18s ease, box-shadow 0.18s ease, transform 0.18s ease",...o},children:e}),L=({children:e,color:n})=>t.jsx("div",{style:{fontSize:10,color:n||s.dim,letterSpacing:"0.1em",textTransform:"uppercase",marginBottom:6,...c},children:e}),R=({text:e,color:n=s.accent,dot:o})=>t.jsxs("span",{style:{background:n+"18",color:n,border:`1px solid ${n}35`,borderRadius:6,padding:"3px 9px",fontSize:11,letterSpacing:"0.04em",...c,display:"inline-flex",alignItems:"center",gap:5,whiteSpace:"nowrap"},children:[o&&t.jsx("span",{style:{width:5,height:5,borderRadius:"50%",background:n,display:"inline-block"}}),e]}),T=({children:e,onClick:n,variant:o="primary",disabled:i,style:r={},size:m="md"})=>{const d={primary:{bg:`linear-gradient(90deg, ${s.accent} 0%, #7BE9CF 100%)`,color:"#04110E",border:`1px solid ${s.accent}55`,shadow:"0 10px 24px rgba(57,221,182,0.26)"},ghost:{bg:"transparent",color:s.text,border:`1px solid ${s.border}`,shadow:"none"},danger:{bg:s.dLow,color:s.danger,border:`1px solid ${s.danger}55`,shadow:"none"},warn:{bg:s.wLow,color:s.warn,border:`1px solid ${s.warn}50`,shadow:"none"}}[o];return t.jsx("button",{onClick:n,disabled:i,onMouseEnter:l=>{i||(l.currentTarget.style.transform="translateY(-1px)",l.currentTarget.style.filter="brightness(1.06)")},onMouseLeave:l=>{l.currentTarget.style.transform="translateY(0)",l.currentTarget.style.filter="brightness(1)"},onMouseDown:l=>{i||(l.currentTarget.style.transform="translateY(0) scale(0.995)")},onMouseUp:l=>{i||(l.currentTarget.style.transform="translateY(-1px) scale(1)")},style:{background:d.bg,color:d.color,border:d.border,borderRadius:10,padding:m==="sm"?"6px 12px":"10px 18px",fontSize:m==="sm"?11:12,cursor:i?"not-allowed":"pointer",opacity:i?.45:1,fontWeight:700,letterSpacing:"0.08em",textTransform:"uppercase",boxShadow:d.shadow,transition:"all 0.16s ease",...c,...r},children:e})},de=({label:e,value:n,onChange:o,placeholder:i,type:r="text",hint:m,suffix:d})=>t.jsxs("div",{style:{marginBottom:16},children:[e&&t.jsx(L,{children:e}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx("input",{value:n,onChange:l=>o(l.target.value),type:r,placeholder:i,style:{width:"100%",background:s.s3,border:`1px solid ${s.border}`,borderRadius:10,color:s.text,padding:`10px ${d?"40px":"12px"} 10px 12px`,fontSize:12,...c,outline:"none",boxSizing:"border-box",transition:"border-color 0.16s ease, box-shadow 0.16s ease"},onFocus:l=>{l.target.style.borderColor=s.accent,l.target.style.boxShadow=`0 0 0 2px ${s.accent}22`},onBlur:l=>{l.target.style.borderColor=s.border,l.target.style.boxShadow="none"}}),d&&t.jsx("span",{style:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",fontSize:11,color:s.dim,...c},children:d})]}),m&&t.jsx("div",{style:{fontSize:11,color:s.dim,marginTop:4},children:m})]}),an=({m:e=12})=>t.jsx("div",{style:{height:1,background:s.border,margin:`${e}px 0`}}),le=({href:e,label:n="â†—"})=>t.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",style:{fontSize:11,color:s.accent,...c,textDecoration:"none",border:`1px solid ${s.accent}25`,padding:"3px 9px",borderRadius:3},children:n});function cn(){return t.jsxs("div",{className:"forge-atmosphere","aria-hidden":"true",children:[t.jsx("div",{className:"forge-atmosphere__aura forge-atmosphere__aura--north"}),t.jsx("div",{className:"forge-atmosphere__aura forge-atmosphere__aura--east"}),t.jsx("div",{className:"forge-atmosphere__aura forge-atmosphere__aura--south"}),t.jsx("div",{className:"forge-atmosphere__grid"}),t.jsxs("div",{className:"forge-atmosphere__rings",children:[t.jsx("span",{className:"forge-ring forge-ring--one"}),t.jsx("span",{className:"forge-ring forge-ring--two"}),t.jsx("span",{className:"forge-ring forge-ring--three"})]}),t.jsxs("div",{className:"forge-atmosphere__blips",children:[t.jsx("span",{className:"forge-blip forge-blip--a"}),t.jsx("span",{className:"forge-blip forge-blip--b"}),t.jsx("span",{className:"forge-blip forge-blip--c"})]})]})}function cs({onConnect:e}){const[n,o]=p.useState(null),[i,r]=p.useState(null),[m,d]=p.useState(""),[l,u]=p.useState(""),[f,y]=p.useState(""),[k,C]=p.useState(""),g=ce.detect(),v=p.useMemo(()=>`forgeos.kaspium.address.${z}`,[]),A=p.useMemo(()=>`forgeos.wallet.lastProvider.${z}`,[]),S=(l.trim()||f.trim()).trim(),D=ie(S,K),$=!!n;p.useEffect(()=>{if(!(typeof window>"u"))try{const _=(window.localStorage.getItem(v)||"").trim();_&&ie(_,K)&&(y(_),u(_));const O=(window.localStorage.getItem(A)||"").trim();O&&C(O)}catch{}},[v,A]);const U=h=>{const _=h.trim();if(!(!_||!ie(_,K))&&(y(_),!(typeof window>"u")))try{window.localStorage.setItem(v,_)}catch{}},ue=h=>{if(C(h),!(typeof window>"u"))try{window.localStorage.setItem(A,h)}catch{}},Y=async()=>{var B;const h=S.trim();if(h&&ie(h,K))return oe(h,K);if(typeof navigator<"u"&&((B=navigator.clipboard)!=null&&B.readText))try{const M=await navigator.clipboard.readText(),X=String(M||"").trim().split(/\s+/)[0]||"";if(X&&ie(X,K)){const b=oe(X,K);return u(b),U(b),b}}catch{}const _=window.prompt(`Paste your ${J} Kaspium address (${K.join(", ")}).`)||"",O=oe(_,K);return u(O),U(O),O},re=async h=>{o(h),r(null),d("");try{let _;if(h==="kasware")_=await ce.connectKasware(),d("Kasware session ready. Extension signing is armed.");else if(h==="kaspium"){const O=await Y();_=ce.connectKaspium(O),U(_.address),d(`Kaspium session ready for ${te(_.address)}.`)}else _={address:os,network:z,provider:"demo"},d("Demo session ready.");ue(h),e(_)}catch(_){r((_==null?void 0:_.message)||"Wallet connection failed.")}o(null)},G=[{k:"kasware",l:"Kasware",desc:"Injected browser wallet for direct signing.",status:g.kasware?"Detected in this tab":"Not detected in this tab",statusColor:g.kasware?s.ok:s.warn,icon:"ðŸ¦Š",docsUrl:"https://github.com/kasware-wallet/extension",cta:"Connect Kasware"},{k:"kaspium",l:"Kaspium",desc:"Mobile wallet via deep-link flow.",status:D?`Address ready Â· ${te(S)}`:"Address resolves on connect",statusColor:D?s.ok:s.warn,icon:"ðŸ“±",docsUrl:"https://github.com/azbuky/kaspium_wallet",cta:D?"Connect Kaspium":"Connect + Pair Address"},{k:"demo",l:"Demo Mode",desc:"Simulated signer for UI testing.",status:"No blockchain broadcast",statusColor:s.dim,icon:"ðŸ§ª",docsUrl:"",cta:"Enter Demo Mode"}];return t.jsxs("div",{className:"forge-shell",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"clamp(18px, 2vw, 28px)"},children:[t.jsx(cn,{}),t.jsxs("div",{className:"forge-content forge-gate-layout",children:[t.jsxs("section",{className:"forge-gate-hero",children:[t.jsxs("div",{children:[t.jsx("div",{className:"forge-gate-kicker",children:"FORGEOS // KASPA-NATIVE QUANT STACK"}),t.jsxs("h1",{className:"forge-gate-title",children:[t.jsx("span",{style:{color:s.accent},children:"FORGE"}),"OS TRADING CONTROL SURFACE"]}),t.jsx("p",{className:"forge-gate-copy",children:"Full-screen command center for wallet-native execution, AI-guided quant cycles, and DAG-aware capital routing. Wallets are treated as installed and ready. Connect instantly and keep signing strictly in-wallet."}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:16},children:[t.jsx(R,{text:`${J} PROFILE`,color:s.ok,dot:!0}),t.jsx(R,{text:"NON-CUSTODIAL SIGNING",color:s.accent,dot:!0}),t.jsx(R,{text:"SESSION REUSE ENABLED",color:s.purple,dot:!0})]})]}),t.jsxs("div",{className:"forge-gate-points",children:[t.jsxs("div",{className:"forge-gate-point",children:[t.jsx("div",{className:"forge-gate-point-value",children:"UTXO-Native"}),t.jsx("div",{className:"forge-gate-point-label",children:"Kaspa-first architecture"})]}),t.jsxs("div",{className:"forge-gate-point",children:[t.jsx("div",{className:"forge-gate-point-value",children:"Non-Custodial"}),t.jsx("div",{className:"forge-gate-point-label",children:"Private keys stay in wallet"})]}),t.jsxs("div",{className:"forge-gate-point",children:[t.jsx("div",{className:"forge-gate-point-value",children:J}),t.jsx("div",{className:"forge-gate-point-label",children:"Active network profile"})]})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.jsxs("div",{style:{marginBottom:18,textAlign:"center"},children:[t.jsxs("div",{style:{fontSize:"clamp(24px, 4vw, 34px)",fontWeight:700,...c,letterSpacing:"0.12em",marginBottom:6},children:[t.jsx("span",{style:{color:s.accent},children:"FORGE"}),t.jsx("span",{style:{color:s.text},children:"OS"})]}),t.jsx("div",{style:{fontSize:11,color:s.dim,letterSpacing:"0.08em",...c},children:"AI-NATIVE FINANCIAL OPERATING SYSTEM Â· POWERED BY KASPA"})]}),t.jsx("div",{className:"forge-content",style:{width:"100%",maxWidth:560},children:t.jsxs(N,{p:32,style:{width:"100%"},children:[t.jsx("div",{style:{fontSize:14,color:s.text,fontWeight:700,...c,marginBottom:4},children:"Connect Wallet"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:14},children:"All operations are wallet-native. No custodial infrastructure. No private keys stored server-side."}),t.jsxs("div",{style:{fontSize:11,color:s.dim,...c,marginBottom:14},children:["Session profile: ",J," Â· allowed prefixes: ",K.join(", ")]}),t.jsx("div",{className:"forge-wallet-grid",children:G.map(h=>t.jsxs("div",{className:`forge-wallet-card ${k===h.k?"forge-wallet-card--preferred":""}`,children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx("div",{style:{fontSize:24,width:34,display:"flex",justifyContent:"center"},children:h.icon}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[t.jsx("div",{style:{fontSize:13,color:s.text,fontWeight:700,...c},children:h.l}),k===h.k?t.jsx(R,{text:"LAST USED",color:s.accent}):null]}),t.jsx("div",{style:{fontSize:11,color:s.dim,marginTop:2},children:h.desc})]}),t.jsx(R,{text:h.status,color:h.statusColor})]}),t.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,flexWrap:"wrap"},children:[t.jsx(T,{onClick:()=>re(h.k),disabled:$&&n!==h.k,variant:h.k==="demo"?"ghost":"primary",size:"sm",style:{minWidth:190},children:n===h.k?"CONNECTING...":h.cta}),h.docsUrl?t.jsx(le,{href:h.docsUrl,label:"DOCS â†—"}):null]})]},h.k))}),t.jsxs("div",{style:{marginTop:14},children:[t.jsx(de,{label:"Kaspium Address (Optional Prefill)",value:l,onChange:h=>{u(h),i&&r(null)},placeholder:`${K[0]}:...`,hint:f?`Saved for ${J}: ${f}`:"Leave blank to auto-pair at connect time"}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[f&&f!==l?t.jsx(T,{onClick:()=>u(f),variant:"ghost",size:"sm",children:"USE SAVED ADDRESS"}):null,t.jsx(T,{onClick:()=>{if(!D){r(`Invalid Kaspium address. Use: ${K.join(", ")}`);return}U(oe(l,K)),r(null),d("Kaspium address saved for faster reconnects.")},disabled:!D,variant:"ghost",size:"sm",children:"SAVE ADDRESS"})]})]}),m?t.jsx("div",{style:{marginTop:12,padding:"10px 14px",background:s.oLow,border:`1px solid ${s.ok}44`,borderRadius:4,fontSize:12,color:s.ok,...c},children:m}):null,i&&t.jsx("div",{style:{marginTop:14,padding:"10px 14px",background:s.dLow,borderRadius:4,fontSize:12,color:s.danger,...c},children:i}),t.jsx(an,{m:18}),t.jsxs("div",{style:{fontSize:11,color:s.dim,...c,lineHeight:1.6},children:["forge.os never requests your private key Â· All transaction signing happens in your wallet Â· ",J," only"]})]})})]})]})]})}function St({tx:e,wallet:n,onSign:o,onReject:i}){const[r,m]=p.useState(!1),[d,l]=p.useState(null),u=async()=>{m(!0),l(null);try{let f;(n==null?void 0:n.provider)==="kasware"?f=await ce.sendKasware(e.to,e.amount_kas):(n==null?void 0:n.provider)==="kaspium"?f=await ce.sendKaspium(e.to,e.amount_kas,e.purpose):(await new Promise(y=>setTimeout(y,1200)),f=Array.from({length:64},()=>"0123456789abcdef"[Math.floor(Math.random()*16)]).join("")),o({...e,txid:f,signed_at:Date.now()})}catch(f){l(f.message)}m(!1)};return t.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},children:t.jsxs(N,{p:28,style:{maxWidth:480,width:"100%",border:`1px solid ${s.warn}40`},children:[t.jsx("div",{style:{fontSize:14,color:s.warn,fontWeight:700,...c,marginBottom:4},children:"âš  TRANSACTION SIGNING REQUIRED"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:18},children:(n==null?void 0:n.provider)==="kasware"?"Kasware will prompt you to sign.":(n==null?void 0:n.provider)==="kaspium"?"Kaspium deep-link will open; paste txid after broadcast.":"Confirm this transaction to proceed."}),t.jsx(N,{p:0,style:{marginBottom:16},children:[["Type",e.type],["From",te(e.from)],["To",te(e.to)],["Amount",`${e.amount_kas} KAS`],["Fee",`${Ke} KAS`],["Purpose",e.purpose]].map(([f,y],k,C)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"9px 14px",borderBottom:k<C.length-1?`1px solid ${s.border}`:"none"},children:[t.jsx("span",{style:{fontSize:12,color:s.dim,...c},children:f}),t.jsx("span",{style:{fontSize:12,color:s.text,...c},children:y})]},f))}),d&&t.jsxs("div",{style:{fontSize:12,color:s.danger,...c,marginBottom:12,padding:"8px 12px",background:s.dLow,borderRadius:4},children:["Error: ",d]}),t.jsxs("div",{style:{display:"flex",gap:10},children:[t.jsx(T,{onClick:i,variant:"ghost",style:{flex:1,padding:"10px 0"},children:"REJECT"}),t.jsx(T,{onClick:u,disabled:r,style:{flex:2,padding:"10px 0"},children:r?"SIGNING...":"SIGN & BROADCAST"})]}),t.jsx("div",{style:{fontSize:11,color:s.dim,marginTop:10,textAlign:"center",...c},children:"Signing occurs client-side Â· Private key never leaves your wallet"})]})})}const ds={name:"",kpiTarget:"12",capitalLimit:"5000",risk:"medium",execMode:"manual",autoApproveThreshold:"50",kpiMetric:"ROI %",horizon:30,revenueSource:"momentum",dataSources:["KAS On-Chain","Kaspa DAG"],frequency:"1h"},ls=[{v:"low",l:"Low",desc:"Tight stops. Max 5% exposure per action."},{v:"medium",l:"Medium",desc:"Balanced Kelly sizing. 10% max exposure."},{v:"high",l:"High",desc:"Aggressive. 20% max. Wide targets."}],ut=[{v:"autonomous",l:"Fully Autonomous",desc:"Auto-signs under threshold. Manual above."},{v:"manual",l:"Manual Approval",desc:"Every action requires wallet signature."},{v:"notify",l:"Notify Only",desc:"Decisions generated, no execution."}],us=({d:e,set:n,wallet:o})=>t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:17,color:s.text,fontWeight:700,marginBottom:3,...c},children:"Configure Agent"}),t.jsxs("div",{style:{fontSize:12,color:s.dim,marginBottom:20},children:["Connected: ",t.jsx("span",{style:{color:s.accent,...c},children:te(o==null?void 0:o.address)})]}),t.jsx(de,{label:"Agent Name",value:e.name,onChange:i=>n("name",i),placeholder:"KAS-Alpha-01"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[t.jsx(de,{label:"ROI Target",value:e.kpiTarget,onChange:i=>n("kpiTarget",i),type:"number",placeholder:"12",suffix:"%"}),t.jsx(de,{label:"Capital / Cycle",value:e.capitalLimit,onChange:i=>n("capitalLimit",i),type:"number",placeholder:"5000",suffix:"KAS"})]}),t.jsx(L,{children:"Risk Tolerance"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:8},children:ls.map(i=>{const r=e.risk===i.v;return t.jsxs("div",{onClick:()=>n("risk",i.v),style:{padding:"12px 10px",borderRadius:4,cursor:"pointer",border:`1px solid ${r?s.accent:s.border}`,background:r?s.aLow:s.s2,textAlign:"center",transition:"all 0.15s"},children:[t.jsx("div",{style:{fontSize:13,color:r?s.accent:s.text,fontWeight:700,...c,marginBottom:3},children:i.l}),t.jsx("div",{style:{fontSize:11,color:s.dim},children:i.desc})]},i.v)})})]}),ps=({d:e,set:n})=>t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:17,color:s.text,fontWeight:700,marginBottom:3,...c},children:"Execution & Signing"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:20},children:"Configure how the agent acts and when your wallet signs."}),ut.map(o=>{const i=e.execMode===o.v;return t.jsxs("div",{onClick:()=>n("execMode",o.v),style:{padding:14,borderRadius:6,marginBottom:10,cursor:"pointer",border:`1px solid ${i?s.accent:s.border}`,background:i?s.aLow:s.s2,transition:"all 0.15s"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:4},children:[t.jsx("div",{style:{width:11,height:11,borderRadius:"50%",border:`2px solid ${i?s.accent:s.muted}`,background:i?s.accent:"transparent",flexShrink:0}}),t.jsx("span",{style:{fontSize:13,color:i?s.accent:s.text,fontWeight:700,...c},children:o.l})]}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginLeft:21},children:o.desc})]},o.v)}),t.jsx(an,{}),t.jsx(de,{label:"Auto-Approve Threshold",value:e.autoApproveThreshold,onChange:o=>n("autoApproveThreshold",o),type:"number",suffix:"KAS",hint:"Transactions under this amount sign automatically in autonomous mode. Above threshold always requires manual wallet signing."})]}),ms=({d:e,wallet:n,onDeploy:o})=>{const i=e.name&&e.capitalLimit&&e.kpiTarget;return t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:17,color:s.text,fontWeight:700,marginBottom:3,...c},children:"Review & Deploy"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:18},children:"Agent vault will be provisioned. Initial funding requires a wallet signature."}),t.jsx(N,{p:0,style:{marginBottom:14},children:[["Agent",e.name||"â€”"],["Wallet",te(n==null?void 0:n.address)],["Network",(n==null?void 0:n.network)||z],["ROI Target",`${e.kpiTarget}%`],["Capital / Cycle",`${e.capitalLimit} KAS`],["Risk",e.risk.toUpperCase()],["Exec Mode",e.execMode.replace(/_/g," ").toUpperCase()],["Auto-Approve Under",`${e.autoApproveThreshold} KAS`]].map(([r,m],d,l)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"9px 16px",borderBottom:d<l.length-1?`1px solid ${s.border}`:"none"},children:[t.jsx("span",{style:{fontSize:12,color:s.dim,...c},children:r}),t.jsx("span",{style:{fontSize:12,color:s.text,...c},children:m})]},r))}),t.jsxs("div",{style:{background:s.wLow,border:`1px solid ${s.warn}30`,borderRadius:4,padding:"10px 14px",marginBottom:16,fontSize:12,color:s.dim},children:["Deployment triggers a wallet signature to provision the agent vault. Vault address: ",t.jsx("span",{style:{color:s.accent,...c},children:te(Ge)})]}),t.jsx(T,{onClick:o,disabled:!i,style:{width:"100%",padding:"11px 0"},children:"DEPLOY AGENT â€” SIGN WITH WALLET"}),!i&&t.jsx("div",{style:{fontSize:11,color:s.warn,marginTop:6,textAlign:"center",...c},children:"Name, capital, and target required."})]})};function fs({wallet:e,onComplete:n}){var C;const[o,i]=p.useState(0),[r,m]=p.useState({...ds}),d=(g,v)=>m(A=>({...A,[g]:v})),[l,u]=p.useState(!1),f=()=>{u(!0)},y=g=>{u(!1),n({...r,wallet:e,deployTx:g,deployedAt:Date.now(),agentId:`forge_${nn()}`})},k={type:"AGENT_DEPLOY",from:e==null?void 0:e.address,to:Ge,amount_kas:parseFloat(r.capitalLimit)||5e3,purpose:"Agent vault provisioning + initial capital"};return t.jsxs("div",{style:{maxWidth:1040,margin:"0 auto",padding:"clamp(18px, 2.2vw, 34px)"},children:[l&&t.jsx(St,{tx:k,wallet:e,onSign:y,onReject:()=>u(!1)}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:22},children:[t.jsx("span",{style:{fontSize:10,color:s.dim,letterSpacing:"0.12em",...c},children:"FORGEOS / NEW AGENT"}),t.jsx("span",{style:{width:1,height:12,background:s.border,display:"inline-block"}}),t.jsx(R,{text:((C=e==null?void 0:e.provider)==null?void 0:C.toUpperCase())||"CONNECTED",color:s.ok,dot:!0})]}),t.jsxs(N,{p:28,style:{maxWidth:680,margin:"0 auto"},children:[t.jsx("div",{style:{display:"flex",gap:5,marginBottom:26},children:[0,1,2].map(g=>t.jsx("div",{style:{height:3,flex:1,borderRadius:2,background:g<=o?s.accent:s.muted,transition:"background 0.3s"}},g))}),o===0&&t.jsx(us,{d:r,set:d,wallet:e}),o===1&&t.jsx(ps,{d:r,set:d}),o===2&&t.jsx(ms,{d:r,wallet:e,onDeploy:f}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:22,paddingTop:16,borderTop:`1px solid ${s.border}`},children:[t.jsx(T,{onClick:()=>i(g=>g-1),variant:"ghost",disabled:o===0,children:"BACK"}),t.jsxs("span",{style:{fontSize:11,color:s.dim,alignSelf:"center",...c},children:["STEP ",o+1," / 3"]}),o<2&&t.jsx(T,{onClick:()=>i(g=>g+1),children:"NEXT"}),o===2&&t.jsx("div",{})]})]})]})}const xs="modulepreload",gs=function(e,n){return new URL(e,n).href},Wt={},yt=function(n,o,i){let r=Promise.resolve();if(o&&o.length>0){const d=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(o.map(f=>{if(f=gs(f,i),f in Wt)return;Wt[f]=!0;const y=f.endsWith(".css"),k=y?'[rel="stylesheet"]':"";if(!!i)for(let v=d.length-1;v>=0;v--){const A=d[v];if(A.href===f&&(!y||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${k}`))return;const g=document.createElement("link");if(g.rel=y?"stylesheet":xs,y||(g.as="script"),g.crossOrigin="",g.href=f,u&&g.setAttribute("nonce",u),document.head.appendChild(g),y)return new Promise((v,A)=>{g.addEventListener("load",v),g.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${f}`)))})}))}function m(d){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=d,window.dispatchEvent(l),!l.defaultPrevented)throw d}return r.then(d=>{for(const l of d||[])l.status==="rejected"&&m(l.reason);return n().catch(m)})},hs=String(qe||"").replace(/\/+$/,""),Fe=Array.from(new Set([hs,...rn.map(e=>String(e||"").replace(/\/+$/,""))])).filter(Boolean),Gt=12e3,Be=2,Es=250,Vt=new Set([408,425,429,500,502,503,504]),Ss=z.startsWith("testnet")?"testnet":"mainnet";function ys(e,n){return`${e}${n}`}function Yt(e){return new Promise(n=>setTimeout(n,e))}function Xt(e){const n=Math.floor(Math.random()*120);return Es*(e+1)+n}function As(e){const n=String(e||"").toLowerCase();return n.includes("tn10")||n.includes("tn11")||n.includes("tn12")||n.includes("testnet")?"testnet":n.includes("api.kaspa.org")||n.includes("mainnet")?"mainnet":"unknown"}function vs(e){const n=String(e||"").toLowerCase();if(n.includes("/addresses/kaspatest:")||n.includes("/addresses/kaspatest%3a"))return"testnet";if(n.includes("/addresses/kaspa:")||n.includes("/addresses/kaspa%3a"))return"mainnet";try{const o=decodeURIComponent(n);if(o.includes("/addresses/kaspatest:"))return"testnet";if(o.includes("/addresses/kaspa:"))return"mainnet"}catch{}return"unknown"}function _s(e){const n=vs(e),o=n==="unknown"?Ss:n;if(o==="unknown")return Fe;const i=Fe.filter(r=>{const m=As(r);return m===o||m==="unknown"});return i.length>0?i:Fe}async function At(e){if(Fe.length===0)throw new Error("No Kaspa API endpoints configured");const n=_s(e),o=[];for(const i of n)for(let r=0;r<Be;r+=1){const m=new AbortController,d=setTimeout(()=>m.abort(),Gt),l=`${r+1}/${Be}`;try{const u=await fetch(ys(i,e),{method:"GET",headers:{Accept:"application/json"},signal:m.signal});if(!u.ok){const f=Number(u.status||0);if(Vt.has(f)&&r+1<Be){await Yt(Xt(r));continue}throw new Error(`${f||"request_failed"}`)}return await u.json()}catch(u){const f=(u==null?void 0:u.name)==="AbortError",y=String((u==null?void 0:u.message)||""),k=Number(y||0),C=Vt.has(k),g=(u==null?void 0:u.name)==="TypeError"||/failed to fetch|network|load failed/i.test(y);if(r+1<Be&&(f||C||g)){await Yt(Xt(r));continue}f?o.push(`${i} timeout (${Gt}ms, attempt ${l})`):g?o.push(`${i} network_error (${y||"request_failed"}, attempt ${l})`):o.push(`${i} ${y||"request_failed"} (attempt ${l})`);break}finally{clearTimeout(d)}}throw new Error(`Kaspa API unavailable for ${e}: ${o.join(" | ")}`)}function dn(e){const n=String(e||"").trim();if(!n)throw new Error("Missing Kaspa address");return encodeURIComponent(n)}function Ts(e){var i;const n=(e==null?void 0:e.balance)??(e==null?void 0:e.totalBalance)??(e==null?void 0:e.availableSompi)??(e==null?void 0:e.balanceSompi)??((i=e==null?void 0:e.balances)==null?void 0:i.total)??0,o=Number(n);return Number.isFinite(o)?Math.max(0,o):0}function js(e,n){var i;const o=(e==null?void 0:e.balanceKas)??(e==null?void 0:e.kas)??(e==null?void 0:e.balance_kas)??((i=e==null?void 0:e.balances)==null?void 0:i.kas);if(o!=null){const r=Number(o);if(Number.isFinite(r))return Math.max(0,r)}return n/1e8}function bs(e){return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.utxos)?e.utxos:Array.isArray(e==null?void 0:e.entries)?e.entries:[]}async function ln(e){const n=await At(`/addresses/${dn(e)}/balance`),o=Ts(n),i=js(n,o);return{kas:xt(i,4),raw:o}}async function Ns(e){const n=await At(`/addresses/${dn(e)}/utxos`);return bs(n)}async function ks(){const e=await At("/info/blockdag");return(e==null?void 0:e.blockdag)??(e==null?void 0:e.blockDag)??e}const Is={},Qe=Is,pt=Qe.VITE_AI_API_URL||"https://api.anthropic.com/v1/messages",Rs=Qe.VITE_AI_MODEL||"claude-sonnet-4-20250514",Ht=Qe.VITE_ANTHROPIC_API_KEY||"",qt=3e4,ot=String(Qe.VITE_AI_FALLBACK_ENABLED||"true").toLowerCase()!=="false";function Cs(){const e={"Content-Type":"application/json"};if(pt.includes("api.anthropic.com")){if(!Ht)throw new Error("Anthropic API key missing. Set VITE_ANTHROPIC_API_KEY or configure VITE_AI_API_URL to your secure backend endpoint.");e["x-api-key"]=Ht,e["anthropic-version"]="2023-06-01"}return e}function ws(e){try{return JSON.parse(e)}catch{throw new Error("AI response was not valid JSON")}}function W(e,n=0){const o=Number(e);return Number.isFinite(o)?o:n}function he(e,n,o){return Math.min(o,Math.max(n,e))}function We(e,n){const o=String((e==null?void 0:e.action)||"HOLD").toUpperCase(),i=["ACCUMULATE","REDUCE","HOLD","REBALANCE"].includes(o)?o:"HOLD",r=Math.max(0,W(n==null?void 0:n.capitalLimit,0)),m=he(W(e==null?void 0:e.capital_allocation_kas,0),0,r),d=r>0?he(m/r*100,0,100):he(W(e==null?void 0:e.capital_allocation_pct,0),0,100),l=he(W(e==null?void 0:e.confidence_score,0),0,1),u=he(W(e==null?void 0:e.risk_score,1),0,1),f=String((e==null?void 0:e.volatility_estimate)||"MEDIUM").toUpperCase(),y=["LOW","MEDIUM","HIGH"].includes(f)?f:"MEDIUM",k=String((e==null?void 0:e.liquidity_impact)||"MODERATE").toUpperCase(),C=["MINIMAL","MODERATE","SIGNIFICANT"].includes(k)?k:"MODERATE",g=String((e==null?void 0:e.strategy_phase)||"HOLDING").toUpperCase(),v=["ENTRY","SCALING","HOLDING","EXIT"].includes(g)?g:"HOLDING",A=Array.isArray(e==null?void 0:e.risk_factors)?e.risk_factors.map(U=>String(U)).filter(Boolean).slice(0,5):[],D=String((e==null?void 0:e.decision_source)||"ai").toLowerCase()==="fallback"?"fallback":"ai",$=String((e==null?void 0:e.decision_source_detail)||"").slice(0,180);return{action:i,confidence_score:l,risk_score:u,kelly_fraction:he(W(e==null?void 0:e.kelly_fraction,0),0,1),capital_allocation_kas:Number(m.toFixed(6)),capital_allocation_pct:Number(d.toFixed(2)),expected_value_pct:Number(W(e==null?void 0:e.expected_value_pct,0).toFixed(2)),stop_loss_pct:Number(Math.max(0,W(e==null?void 0:e.stop_loss_pct,0)).toFixed(2)),take_profit_pct:Number(Math.max(0,W(e==null?void 0:e.take_profit_pct,0)).toFixed(2)),monte_carlo_win_pct:Number(he(W(e==null?void 0:e.monte_carlo_win_pct,0),0,100).toFixed(2)),volatility_estimate:y,liquidity_impact:C,strategy_phase:v,rationale:String((e==null?void 0:e.rationale)||"No rationale returned by AI engine."),risk_factors:A,next_review_trigger:String((e==null?void 0:e.next_review_trigger)||"On next cycle or major DAA/price movement."),decision_source:D,decision_source_detail:$}}function rt(e,n,o){var C;const i=Math.max(0,W(e==null?void 0:e.capitalLimit,0)),r=String((e==null?void 0:e.risk)||"medium").toLowerCase(),m=r==="low"?.04:r==="high"?.12:.08,d=Math.max(0,W(n==null?void 0:n.walletKas,i)),l=W((C=n==null?void 0:n.dag)==null?void 0:C.daaScore,0),u=Math.abs(Math.floor(l))%4,f=d>1&&u!==0,y=f?"ACCUMULATE":"HOLD",k=f?Math.min(i*m,d*.15):0;return We({action:y,confidence_score:f?.79:.73,risk_score:r==="low"?.29:r==="high"?.61:.43,kelly_fraction:f?m:0,capital_allocation_kas:k,expected_value_pct:f?1.8:.2,stop_loss_pct:f?4.8:0,take_profit_pct:f?9.5:0,monte_carlo_win_pct:f?56:51,volatility_estimate:u>=2?"MEDIUM":"LOW",liquidity_impact:k>i*.1?"MODERATE":"MINIMAL",strategy_phase:f?"SCALING":"HOLDING",rationale:`Fallback quant policy activated due to upstream AI unavailability (${o}). Using conservative Kaspa-native accumulation posture with explicit risk cap.`,risk_factors:["AI endpoint unavailable","Fallback deterministic sizing active","Execution remains wallet-signed"],next_review_trigger:"Re-run after next DAG refresh or when AI endpoint connectivity is restored.",decision_source:"fallback",decision_source_detail:`fallback_reason:${o}`},e)}async function Ls(e,n){var l;const o=`You are a quant-grade AI financial agent operating on the Kaspa blockchain. You use adversarial financial reasoning. Respond ONLY with a valid JSON object â€” no markdown, no prose, no code fences.

AGENT PROFILE:
Name: ${e.name}
Strategy: momentum / on-chain flow analysis
Risk Tolerance: ${e.risk} (low=conservative, high=aggressive)
KPI Target: ${e.kpiTarget}% ROI
Capital per Cycle: ${e.capitalLimit} KAS
Auto-Approve Threshold: ${e.autoApproveThreshold} KAS

KASPA ON-CHAIN DATA:
${JSON.stringify(n,null,2)}

REASONING REQUIREMENTS:
1. Apply Kelly Criterion for position sizing (kelly_fraction field)
2. Run mental Monte Carlo: estimate win probability across 100 simulated scenarios
3. Assess volatility clustering from DAA score velocity
4. Model liquidity impact of proposed position size
5. Identify behavioral finance signals (momentum, mean reversion)
6. Assess multi-step plan: entry â†’ management â†’ exit

OUTPUT (strict JSON, all fields required):
{
  "action": "ACCUMULATE or REDUCE or HOLD or REBALANCE",
  "confidence_score": 0.00,
  "risk_score": 0.00,
  "kelly_fraction": 0.00,
  "capital_allocation_kas": 0.00,
  "capital_allocation_pct": 0,
  "expected_value_pct": 0.00,
  "stop_loss_pct": 0.00,
  "take_profit_pct": 0.00,
  "monte_carlo_win_pct": 0,
  "volatility_estimate": "LOW or MEDIUM or HIGH",
  "liquidity_impact": "MINIMAL or MODERATE or SIGNIFICANT",
  "strategy_phase": "ENTRY or SCALING or HOLDING or EXIT",
  "rationale": "Two concise sentences citing specific on-chain signals and indicator logic.",
  "risk_factors": ["factor1", "factor2", "factor3"],
  "next_review_trigger": "Describe the specific condition that should trigger next decision cycle"
}`,i=pt.includes("api.anthropic.com")?{model:Rs,max_tokens:800,messages:[{role:"user",content:o}]}:{prompt:o,agent:e,kasData:n},r=new AbortController,m=setTimeout(()=>r.abort(),qt);let d;try{const u=await fetch(pt,{method:"POST",headers:Cs(),body:JSON.stringify(i),signal:r.signal});if(!u.ok)throw new Error(`AI endpoint ${u.status}`);d=await u.json()}catch(u){if(ot)return rt(e,n,(u==null?void 0:u.name)==="AbortError"?"timeout":(u==null?void 0:u.message)||"request failure");throw(u==null?void 0:u.name)==="AbortError"?new Error(`AI request timeout (${qt}ms)`):u}finally{clearTimeout(m)}if((l=d==null?void 0:d.error)!=null&&l.message)throw new Error(d.error.message);if(Array.isArray(d==null?void 0:d.content))try{const u=d.content.map(y=>y.text||"").join(""),f=ws(u.replace(/```json|```/g,"").trim());return We({...f,decision_source:"ai"},e)}catch(u){if(ot)return rt(e,n,(u==null?void 0:u.message)||"invalid AI payload");throw u}try{return d!=null&&d.decision?We({...d.decision,decision_source:"ai"},e):We({...d,decision_source:"ai"},e)}catch(u){if(ot)return rt(e,n,(u==null?void 0:u.message)||"invalid decision format");throw u}}const Os={SYSTEM:s.dim,DATA:"#6BA3FF",AI:s.accent,VALID:s.warn,EXEC:s.ok,ERROR:s.danger,SIGN:s.purple,TREASURY:s.warn},it=e=>{const n=Date.now();return[{ts:n-72e5,type:"SYSTEM",msg:`Agent ${e} provisioned. Vault address mapped to session.`,fee:null},{ts:n-714e4,type:"SIGN",msg:"Deploy transaction signed via Kasware. Vault funded.",fee:null},{ts:n-71e5,type:"TREASURY",msg:"Protocol fee: 0.20 KAS â†’ Treasury 0.06 KAS / Pool 0.14 KAS",fee:.2},{ts:n-36e5,type:"DATA",msg:"Kaspa DAG snapshot ingested. DAA score, hashrate, UTXO set analysed.",fee:null},{ts:n-354e4,type:"AI",msg:"Quant engine invoked. Kelly criterion + Monte Carlo computed.",fee:.12},{ts:n-35e5,type:"VALID",msg:"Risk gate PASSED Â· Conf 0.82 Â· Kelly 0.08 Â· Phase: ENTRY",fee:null},{ts:n-349e4,type:"EXEC",msg:"ACCUMULATE â€” 400 KAS Â· Auto-approved (below threshold)",fee:.08},{ts:n-18e5,type:"AI",msg:"Quant engine invoked.",fee:.12},{ts:n-178e4,type:"VALID",msg:"Conf 0.71 < 0.75 threshold â€” HOLD enforced.",fee:null},{ts:n-177e4,type:"EXEC",msg:"HOLD â€” confidence gate. Position maintained.",fee:.08}]},Ds="forgeos.usage.v2",Ms="forgeos.usage.v1";function Ks(e){return String(e||"global").trim().toLowerCase().replace(/[^a-z0-9:_-]/g,"_").slice(0,128)||"global"}function un(e){return`${Ds}:${Ks(e)}`}function Us(e=new Date){return e.toISOString().slice(0,10)}function $s(e){if(typeof window>"u")return null;try{const n=window.localStorage.getItem(un(e));if(!n)return null;const o=JSON.parse(n);return!o||typeof o.day!="string"||!Number.isFinite(o.used)?null:{day:o.day,used:Math.max(0,Math.floor(o.used))}}catch{return null}}function mt(e,n){if(!(typeof window>"u"))try{window.localStorage.setItem(un(n),JSON.stringify(e))}catch{}}function Ps(){if(typeof window>"u")return null;try{const e=window.localStorage.getItem(Ms);if(!e)return null;const n=JSON.parse(e);return!n||typeof n.day!="string"||!Number.isFinite(n.used)?null:{day:n.day,used:Math.max(0,Math.floor(n.used))}}catch{return null}}function pn(e,n){const o=Us(),i=$s(n)||(n?null:Ps());if(!i||i.day!==o){const m={day:o,used:0};return mt(m,n),m}const r={day:o,used:Math.min(i.used,Math.max(0,Math.floor(e)))};return mt(r,n),r}function ft(e,n){const o=Math.max(1,Math.floor(n)),i=Math.min(e.used,o),r=Math.max(0,o-i);return{day:e.day,used:i,limit:o,remaining:r,locked:r<=0}}function zs(e,n){return ft(pn(e,n),e)}function Bs(e,n){const o=pn(e,n),i=Math.max(1,Math.floor(e));if(o.used>=i)return ft(o,i);const r={...o,used:o.used+1};return mt(r,n),ft(r,i)}function Qt(e,n){return zs(e,n)}const Fs="forgeos.dashboard.v1",Ws=160,Gs=320,Vs=120;function Ys(e){return String(e||"default").trim().toLowerCase().replace(/[^a-z0-9:_-]/g,"_").slice(0,180)}function mn(e){const n=Ys(e);return`${Fs}:${n||"default"}`}function at(e,n){return Array.isArray(e)?e.slice(0,n):[]}function fn(e){return{version:1,updatedAt:Date.now(),status:e.status==="RUNNING"||e.status==="PAUSED"||e.status==="SUSPENDED"?e.status:"RUNNING",execMode:e.execMode==="autonomous"||e.execMode==="manual"||e.execMode==="notify"?e.execMode:"manual",liveExecutionArmed:!!e.liveExecutionArmed,nextAutoCycleAt:Number.isFinite(e.nextAutoCycleAt)&&Number(e.nextAutoCycleAt)>0?Number(e.nextAutoCycleAt):void 0,queue:at(e.queue,Ws),log:at(e.log,Gs),decisions:at(e.decisions,Vs)}}function Xs(e){if(typeof window>"u")return null;try{const n=window.localStorage.getItem(mn(e));if(!n)return null;const o=JSON.parse(n);return fn(o)}catch{return null}}function Hs(e,n){if(!(typeof window>"u"))try{const o=fn(n);window.localStorage.setItem(mn(e),JSON.stringify(o))}catch{}}function qs({queue:e,wallet:n,onSign:o,onReject:i}){return t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:13,color:s.text,fontWeight:700,...c,marginBottom:4},children:"Action Queue"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:16},children:"Transactions pending wallet signature. Auto-approved items processed immediately."}),e.length===0&&t.jsxs(N,{p:32,style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:13,color:s.dim,...c,marginBottom:4},children:"Queue empty"}),t.jsx("div",{style:{fontSize:12,color:s.dim},children:"Pending transactions will appear here awaiting your wallet signature."})]}),e.map(r=>t.jsxs(N,{p:18,style:{marginBottom:10,border:`1px solid ${r.status==="pending"?s.warn:r.status==="signed"?s.ok:s.border}25`},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:4},children:[t.jsx(R,{text:r.type,color:s.purple}),t.jsx(R,{text:r.status.toUpperCase(),color:r.status==="pending"?s.warn:r.status==="signed"?s.ok:s.dim,dot:!0})]}),t.jsx("div",{style:{fontSize:11,color:s.dim,...c},children:tn(r.ts)})]}),t.jsxs("div",{style:{fontSize:18,color:r.amount_kas>0?s.accent:s.danger,fontWeight:700,...c},children:[r.amount_kas," KAS"]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:r.status==="pending"?12:0,fontSize:12,color:s.dim,...c},children:[t.jsxs("div",{children:["To: ",t.jsx("span",{style:{color:s.text},children:te(r.to)})]}),t.jsxs("div",{children:["Fee split: ",t.jsxs("span",{style:{color:s.text},children:["Pool ",(ee*lt).toFixed(4)," / Treasury ",(ee*ae).toFixed(4)]})]})]}),r.status==="pending"&&t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsx(T,{onClick:()=>i(r.id),variant:"danger",size:"sm",children:"REJECT"}),t.jsx(T,{onClick:()=>o(r),size:"sm",children:"SIGN & BROADCAST"})]}),r.status==="signed"&&r.txid&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[t.jsxs("span",{style:{fontSize:11,color:s.ok,...c},children:["âœ“ ",r.txid.slice(0,32),"..."]}),t.jsx(le,{href:`${ve}/txs/${r.txid}`,label:"EXPLORER â†—"})]})]},r.id))]})}function Qs({usage:e}){const n=p.useMemo(()=>Math.min(100,Math.round(e.used/Math.max(1,e.limit)*100)),[e.limit,e.used]);return t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:13,color:s.text,fontWeight:700,...c,marginBottom:4},children:"Billing & Usage"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:16},children:"Usage-based monetization: free daily quant cycles with upgrade path after quota is reached."}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:10,marginBottom:14},children:[t.jsxs(N,{p:14,children:[t.jsx(L,{children:"Plan"}),t.jsx("div",{style:{fontSize:18,color:s.text,fontWeight:700,...c},children:"FREE"}),t.jsxs("div",{style:{fontSize:11,color:s.dim},children:["Up to ",_e," cycles/day"]})]}),t.jsxs(N,{p:14,children:[t.jsx(L,{children:"Cycles Used Today"}),t.jsx("div",{style:{fontSize:18,color:s.warn,fontWeight:700,...c},children:e.used}),t.jsxs("div",{style:{fontSize:11,color:s.dim},children:["of ",e.limit]})]}),t.jsxs(N,{p:14,children:[t.jsx(L,{children:"Cycles Remaining"}),t.jsx("div",{style:{fontSize:18,color:e.locked?s.danger:s.ok,fontWeight:700,...c},children:e.remaining}),t.jsx("div",{style:{fontSize:11,color:s.dim},children:"resets daily (UTC)"})]})]}),t.jsxs(N,{p:16,style:{marginBottom:12},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[t.jsx(L,{children:"Daily Quota Progress"}),t.jsx(R,{text:e.locked?"LOCKED":"ACTIVE",color:e.locked?s.danger:s.ok,dot:!0})]}),t.jsx("div",{style:{height:8,borderRadius:999,background:s.s2,border:`1px solid ${s.border}`,overflow:"hidden"},children:t.jsx("div",{style:{width:`${n}%`,height:"100%",background:e.locked?s.danger:s.accent,transition:"width 180ms ease"}})}),t.jsxs("div",{style:{marginTop:8,fontSize:11,color:s.dim,...c},children:[n,"% of daily free quota consumed"]})]}),t.jsxs(N,{p:16,children:[t.jsx(L,{children:"Upgrade / Payments"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:10},children:"Set `VITE_BILLING_UPGRADE_URL` for hosted checkout, or accept direct KAS payments at treasury."}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:[Ve?t.jsx(le,{href:Ve,label:"OPEN CHECKOUT â†—"}):t.jsx(R,{text:"NO CHECKOUT URL SET",color:s.warn}),Bt&&t.jsx(R,{text:`CONTACT ${Bt}`,color:s.dim})]}),t.jsx("div",{style:{fontSize:11,color:s.accent,...c,wordBreak:"break-all",marginBottom:8},children:Pt}),t.jsx(T,{onClick:()=>{var o;return(o=navigator.clipboard)==null?void 0:o.writeText(Pt)},variant:"ghost",size:"sm",children:"COPY TREASURY ADDRESS"})]})]})}function Js({agent:e,wallet:n}){var X,b;const[o,i]=p.useState(null),[r,m]=p.useState([]),[d,l]=p.useState(!1),[u,f]=p.useState(null),[y,k]=p.useState(null),[C,g]=p.useState(null),[v,A]=p.useState(""),[S,D]=p.useState(""),[$,U]=p.useState(""),[ue,Y]=p.useState(typeof window<"u"?window.innerWidth:1200),re=p.useCallback(async()=>{l(!0),f(null);try{let w;(n==null?void 0:n.provider)==="kasware"?w=await ce.getKaswareBalance():w=(await ln((n==null?void 0:n.address)||e.wallet)).kas;const H=await Ns((n==null?void 0:n.address)||e.wallet);i(w),m(Array.isArray(H)?H.slice(0,10):[]),k(new Date)}catch(w){f(w.message)}l(!1)},[n,e]);p.useEffect(()=>{re()},[re]),p.useEffect(()=>{if(typeof window>"u")return;const w=()=>Y(window.innerWidth);return window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]);const G=parseFloat(o??e.capitalLimit??0),h=Math.max(0,G-Me-Ke),_=h.toFixed(4),O=ue<760,B=()=>{const w=Number(S);!ie(v,K)||!(w>0)||w>h||g({type:"WITHDRAW",from:n==null?void 0:n.address,to:v,amount_kas:Number(w.toFixed(6)),purpose:$||"Withdrawal"})},M=()=>{g(null),A(""),D(""),U("")};return t.jsxs("div",{children:[C&&t.jsx(St,{tx:C,wallet:n,onSign:M,onReject:()=>g(null)}),t.jsxs(N,{p:20,style:{marginBottom:12},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:14},children:[t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs(L,{children:["Connected Wallet â€” ",J]}),t.jsx("div",{style:{fontSize:12,color:s.accent,...c,wordBreak:"break-all",marginBottom:10},children:(n==null?void 0:n.address)||"â€”"}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[t.jsx(T,{onClick:()=>{var w;return(w=navigator.clipboard)==null?void 0:w.writeText((n==null?void 0:n.address)||"")},variant:"ghost",size:"sm",children:"COPY"}),t.jsx(le,{href:`${ve}/addresses/${n==null?void 0:n.address}`,label:"EXPLORER â†—"})]})]}),t.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexShrink:0,marginLeft:14},children:[t.jsx(R,{text:(n==null?void 0:n.provider)==="demo"?"DEMO":((X=n==null?void 0:n.provider)==null?void 0:X.toUpperCase())||"â€”",color:(n==null?void 0:n.provider)==="kasware"?s.ok:s.warn,dot:!0}),t.jsx(T,{onClick:re,disabled:d,size:"sm",variant:"ghost",children:d?"...":"REFRESH"})]})]}),u&&t.jsxs("div",{style:{background:s.dLow,border:`1px solid ${s.danger}30`,borderRadius:4,padding:"8px 12px",marginBottom:12,fontSize:12,color:s.danger,...c},children:["RPC: ",u]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:O?"1fr":"repeat(3,1fr)",gap:12},children:[["Balance",`${o??e.capitalLimit} KAS`,o?s.accent:s.warn],["UTXOs",o?String(r.length):"â€”",s.text],["Network",(n==null?void 0:n.network)||z,s.dim]].map(([w,H,pe])=>t.jsxs("div",{children:[t.jsx(L,{children:w}),t.jsx("div",{style:{fontSize:18,color:pe,fontWeight:700,...c},children:H})]},w))}),y&&t.jsxs("div",{style:{fontSize:11,color:s.dim,marginTop:8,...c},children:["Fetched ",y.toLocaleTimeString()," via ",qe]})]}),t.jsxs(N,{p:20,style:{marginBottom:12},children:[t.jsx(L,{children:"Withdraw KAS"}),t.jsxs("div",{style:{background:s.s2,borderRadius:4,padding:"9px 13px",marginBottom:12,display:"flex",justifyContent:"space-between"},children:[t.jsxs("span",{style:{fontSize:11,color:s.dim,...c},children:["Available (after ",Me," KAS reserve)"]}),t.jsxs("span",{style:{fontSize:14,color:s.accent,fontWeight:700,...c},children:[_," KAS"]})]}),t.jsx(de,{label:"Recipient Address",value:v,onChange:A,placeholder:"kaspa:... or kaspatest:..."}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:O?"1fr":"1fr auto",gap:8,alignItems:"flex-end",marginBottom:12},children:[t.jsx(de,{label:`Amount (max ${_} KAS)`,value:S,onChange:D,type:"number",suffix:"KAS",placeholder:"0.0000"}),t.jsx(T,{onClick:()=>D(_),variant:"ghost",size:"sm",style:{marginBottom:1},children:"MAX"})]}),t.jsx(de,{label:"Note (optional)",value:$,onChange:U,placeholder:"e.g. Profit extraction"}),t.jsxs(T,{onClick:B,disabled:!ie(v,K)||!(Number(S)>0)||Number(S)>h,style:{width:"100%",padding:"10px 0"},children:["INITIATE WITHDRAWAL â€” SIGN WITH ",((b=n==null?void 0:n.provider)==null?void 0:b.toUpperCase())||"WALLET"]}),Number(S||0)>h&&t.jsx("div",{style:{fontSize:11,color:s.warn,marginTop:6,...c},children:"Requested withdrawal exceeds available amount after reserve and network fee."})]}),t.jsxs(N,{p:20,style:{marginBottom:12},children:[t.jsx(L,{children:"Deposit KAS"}),t.jsx("div",{style:{fontSize:12,color:s.dim,marginBottom:12},children:"Send KAS directly to your connected wallet address. Funds are available after DAG confirmation (~1â€“2s)."}),t.jsxs("div",{style:{background:s.s2,borderRadius:4,padding:14,border:`1px solid ${s.accent}25`},children:[t.jsx("div",{style:{fontSize:12,color:s.accent,...c,wordBreak:"break-all",marginBottom:10},children:(n==null?void 0:n.address)||"â€”"}),t.jsx(le,{href:`${ve}/addresses/${n==null?void 0:n.address}`,label:"VIEW ON KASPA EXPLORER â†—"})]})]}),r.length>0&&t.jsxs(N,{p:0,children:[t.jsx("div",{style:{padding:"11px 16px",borderBottom:`1px solid ${s.border}`,display:"flex",justifyContent:"space-between"},children:t.jsxs("span",{style:{fontSize:11,color:s.dim,...c},children:["UTXO SET â€” ",r.length," outputs"]})}),r.map((w,H)=>{var ne,be,Ne;const pe=xt((((ne=w.utxoEntry)==null?void 0:ne.amount)||0)/1e8,4),me=(be=w.utxoEntry)==null?void 0:be.blockDaaScore,fe=(Ne=w.outpoint)==null?void 0:Ne.transactionId;return t.jsxs("div",{style:{display:"grid",gridTemplateColumns:O?"1fr":"1fr 100px 120px 60px",gap:8,padding:"8px 16px",borderBottom:`1px solid ${s.border}`,alignItems:"center"},children:[t.jsxs("span",{style:{fontSize:11,color:s.dim,...c,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[fe==null?void 0:fe.slice(0,34),"..."]}),t.jsxs("span",{style:{fontSize:12,color:s.ok,fontWeight:700,...c,textAlign:O?"left":"right"},children:[pe," KAS"]}),t.jsxs("span",{style:{fontSize:11,color:s.dim,...c,textAlign:O?"left":"right"},children:["DAA ",me]}),t.jsx("div",{style:{textAlign:O?"left":"right"},children:t.jsx(le,{href:`${ve}/txs/${fe}`,label:"â†—"})})]},H)})]})]})}const Zs=p.lazy(()=>yt(()=>import("./PerfChart-BE1lSwBm.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>({default:e.PerfChart}))),eo=p.lazy(()=>yt(()=>import("./IntelligencePanel-M1Mohq5u.js"),__vite__mapDeps([2,1]),import.meta.url).then(e=>({default:e.IntelligencePanel}))),to=p.lazy(()=>yt(()=>import("./TreasuryPanel-CxY1bMju.js"),__vite__mapDeps([3,1]),import.meta.url).then(e=>({default:e.TreasuryPanel})));function no({agent:e,wallet:n}){var wt,Lt,Ot,Dt,Mt;const l=Ye*1e3,u=`${z}:${String((n==null?void 0:n.address)||"unknown").toLowerCase()}`,f=`${z}:${String((n==null?void 0:n.address)||"unknown").toLowerCase()}:${String((e==null?void 0:e.agentId)||(e==null?void 0:e.name)||"default").toLowerCase()}`,y=p.useRef(!1),[k,C]=p.useState(!1),[g,v]=p.useState("overview"),[A,S]=p.useState("RUNNING"),[D,$]=p.useState(()=>it(e.name)),[U,ue]=p.useState([]),[Y,re]=p.useState(!1),[G,h]=p.useState(e.execMode||"manual"),[_]=p.useState(parseFloat(e.autoApproveThreshold)||50),[O,B]=p.useState([]),[M,X]=p.useState(null),[b,w]=p.useState(null),[H,pe]=p.useState(!0),[me,fe]=p.useState(null),[ne,be]=p.useState(!1),[Ne,Je]=p.useState(!1),[vt,_t]=p.useState(0),[ke,Tt]=p.useState(()=>Qt(_e,u)),[F,Ie]=p.useState(st),[Re,Ce]=p.useState(()=>Date.now()+l),[jt,xn]=p.useState(typeof window<"u"?window.innerWidth:1200),I=p.useCallback(a=>$(E=>[{ts:Date.now(),...a},...E].slice(0,320)),[320]),Se=p.useCallback(async()=>{pe(!0),fe(null);try{const[a,E]=await Promise.all([ks(),ln(n==null?void 0:n.address)]);w({dag:a,walletKas:E.kas,address:n==null?void 0:n.address,fetched:Date.now()}),be(!0)}catch(a){be(!1),fe((a==null?void 0:a.message)||"Kaspa live feed disconnected")}pe(!1)},[n]);p.useEffect(()=>{Tt(Qt(_e,u))},[u]),p.useEffect(()=>{C(!1);const a=Xs(f);a?(a.status&&S(a.status),a.execMode&&ut.some(E=>E.v===a.execMode)?h(a.execMode):h(e.execMode||"manual"),typeof a.liveExecutionArmed=="boolean"?Ie(a.liveExecutionArmed):Ie(st),B(Array.isArray(a.queue)?a.queue.slice(0,160):[]),$(Array.isArray(a.log)&&a.log.length>0?a.log.slice(0,320):it(e.name)),ue(Array.isArray(a.decisions)?a.decisions.slice(0,120):[]),Ce(Number.isFinite(a.nextAutoCycleAt)?Math.max(Date.now()+1e3,Number(a.nextAutoCycleAt)):Date.now()+l)):(S("RUNNING"),h(e.execMode||"manual"),Ie(st),B([]),ue([]),$(it(e.name)),Ce(Date.now()+l)),C(!0)},[e.execMode,e.name,l,f,120,320,160]),p.useEffect(()=>{k&&Hs(f,{status:A,execMode:G,liveExecutionArmed:F,queue:O,log:D,decisions:U,nextAutoCycleAt:Re})},[U,G,F,D,Re,O,k,f,A]),p.useEffect(()=>{Se();const a=setInterval(Se,5e3);let E=null,x=null,P=null,xe=!1,Ae=0;const et=()=>{if(xe||!ge)return;const Z=Math.min(12e3,1200*2**Ae);Ae+=1,_t(Ae),P=setTimeout(()=>{P=null,Oe()},Z)},Oe=()=>{!ge||xe||(E=new WebSocket(ge),E.onopen=()=>{Ae=0,_t(0),Je(!0)},E.onmessage=()=>{x||(x=setTimeout(()=>{x=null,Se()},1200))},E.onerror=()=>{xe||Je(!1)},E.onclose=()=>{Je(!1),xe||et()})};return ge&&Oe(),()=>{xe=!0,clearInterval(a),x&&(clearTimeout(x),x=null),P&&(clearTimeout(P),P=null),E&&E.close()}},[Se]),p.useEffect(()=>{if(typeof window>"u")return;const a=()=>xn(window.innerWidth);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),p.useEffect(()=>{A==="RUNNING"&&Ce(Date.now()+l)},[A,l]);const V=jt<760,we=jt<1024,gn=p.useMemo(()=>V?"1fr":we?"repeat(2,1fr)":"repeat(4,1fr)",[V,we]),hn=we?"1fr":"2fr 1fr",En=we?"1fr":"1fr 1fr",bt=e.risk==="low"?.4:e.risk==="medium"?.65:.85,Le=async()=>{var a;if(!(y.current||A!=="RUNNING"||!k)){y.current=!0,re(!0);try{if(!b){I({type:"ERROR",msg:"No live Kaspa data available. Reconnect feed before running cycle.",fee:null});return}Ce(Date.now()+l),I({type:"DATA",msg:`Kaspa DAG snapshot: DAA ${((a=b==null?void 0:b.dag)==null?void 0:a.daaScore)||"â€”"} Â· Wallet ${(b==null?void 0:b.walletKas)||"â€”"} KAS`,fee:null});const E=Bs(_e,u);if(Tt(E),E.locked){v("billing"),I({type:"SYSTEM",msg:`Daily free cycle quota reached (${E.used}/${E.limit}). Upgrade required for additional runs.`,fee:null});return}const x=await Ls(e,b||{}),P=(x==null?void 0:x.decision_source)==="fallback"?"fallback":"ai";nt&&!["ACCUMULATE","HOLD"].includes(x.action)&&(x.action="HOLD",x.rationale=`${String(x.rationale||"")} Execution constrained by accumulate-only mode.`.trim()),I({type:"AI",msg:`${x.action} Â· Conf ${x.confidence_score} Â· Kelly ${(x.kelly_fraction*100).toFixed(1)}% Â· Monte Carlo ${x.monte_carlo_win_pct}% win Â· source:${P}`,fee:.12}),P==="fallback"&&I({type:"SYSTEM",msg:`Fallback decision source active (${(x==null?void 0:x.decision_source_detail)||"ai endpoint unavailable"}). Auto-approve disabled for this cycle.`,fee:null});const xe=x.confidence_score>=zt,Ae=x.risk_score<=bt,et=Number((b==null?void 0:b.walletKas)||0),Oe=Math.max(0,et-Me-Ke);if(!Ae)I({type:"VALID",msg:`Risk gate FAILED â€” score ${x.risk_score} > ${bt} ceiling`,fee:null}),I({type:"EXEC",msg:"BLOCKED by risk gate",fee:.03});else if(!xe)I({type:"VALID",msg:`Confidence ${x.confidence_score} < ${zt} threshold`,fee:null}),I({type:"EXEC",msg:"HOLD â€” confidence gate enforced",fee:.08});else if(x.action==="ACCUMULATE"&&Oe<=0)I({type:"VALID",msg:`Insufficient spendable balance after reserve (${Me} KAS + ${Ke} KAS network fee).`,fee:null}),I({type:"EXEC",msg:"HOLD â€” waiting for available balance",fee:.03});else if(I({type:"VALID",msg:`Risk OK (${x.risk_score}) Â· Conf OK (${x.confidence_score}) Â· Kelly ${(x.kelly_fraction*100).toFixed(1)}%`,fee:null}),ue(Z=>[{ts:Date.now(),dec:x,kasData:b,source:P},...Z].slice(0,120)),G==="notify")I({type:"EXEC",msg:`NOTIFY mode active â€” ${x.action} signal recorded, no transaction broadcast.`,fee:.01});else if(!F||!$e){const Z=F?"network feed or wallet provider is not execution-ready":"live execution is disarmed";I({type:"EXEC",msg:`Signal generated (${x.action}) but no transaction broadcast because ${Z}.`,fee:.01})}else if(x.action!=="HOLD"){const Z=Number(x.capital_allocation_kas||0),Pe=x.action==="ACCUMULATE"?Math.min(Z,Oe):Z;if(Z>Pe&&I({type:"SYSTEM",msg:`Clamped execution amount from ${Z} to ${Pe.toFixed(4)} KAS (available balance guardrail).`,fee:null}),!(Pe>0)){I({type:"EXEC",msg:"HOLD â€” computed execution amount is zero",fee:.03});return}const q={id:nn(),type:x.action,from:n==null?void 0:n.address,to:Ge,amount_kas:Number(Pe.toFixed(6)),purpose:x.rationale.slice(0,60),status:"pending",ts:Date.now(),dec:x};if(G==="autonomous"&&q.amount_kas<=_&&P==="ai")try{let Q="";(n==null?void 0:n.provider)==="kasware"?Q=await ce.sendKasware(q.to,q.amount_kas):(n==null?void 0:n.provider)==="kaspium"?Q=await ce.sendKaspium(q.to,q.amount_kas,q.purpose):(await new Promise(De=>setTimeout(De,400)),Q=Array.from({length:64},()=>"0123456789abcdef"[Math.floor(Math.random()*16)]).join("")),I({type:"EXEC",msg:`AUTO-APPROVED: ${x.action} Â· ${q.amount_kas} KAS Â· txid: ${Q.slice(0,16)}...`,fee:.08}),I({type:"TREASURY",msg:`Fee split â†’ Pool: ${(ee*lt).toFixed(4)} KAS / Treasury: ${(ee*ae).toFixed(4)} KAS`,fee:ee}),B(De=>[{...q,status:"signed",txid:Q},...De].slice(0,160))}catch(Q){B(De=>[q,...De].slice(0,160)),I({type:"SIGN",msg:`Auto-approve fallback to manual queue: ${(Q==null?void 0:Q.message)||"wallet broadcast failed"}`,fee:null})}else I({type:"SIGN",msg:`Action queued for wallet signature: ${x.action} Â· ${q.amount_kas} KAS`,fee:null}),B(Q=>[q,...Q].slice(0,160))}else I({type:"EXEC",msg:"HOLD â€” no action taken",fee:.08})}catch(E){I({type:"ERROR",msg:E.message,fee:null})}finally{re(!1),y.current=!1}}};p.useEffect(()=>{if(A!=="RUNNING"||!k)return;const a=setInterval(()=>{y.current||Y||!ne||me||Date.now()<Re||(Ce(Date.now()+l),Le())},1e3);return()=>clearInterval(a)},[A,Y,ne,me,Re,l,Le,k]);const Sn=a=>{X(a)},Nt=a=>{B(E=>E.map(x=>x.id===a?{...x,status:"rejected"}:x)),I({type:"SIGN",msg:`Transaction rejected by operator: ${a}`,fee:null})},yn=()=>{M!=null&&M.id&&Nt(M.id),X(null)},An=a=>{var E;B(x=>x.map(P=>P.id===(M==null?void 0:M.id)?{...P,status:"signed",txid:a.txid}:P)),I({type:"EXEC",msg:`SIGNED: ${M==null?void 0:M.type} Â· ${M==null?void 0:M.amount_kas} KAS Â· txid: ${(E=a.txid)==null?void 0:E.slice(0,16)}...`,fee:.08}),I({type:"TREASURY",msg:`Fee split â†’ Pool: ${(ee*lt).toFixed(4)} KAS / Treasury: ${(ee*ae).toFixed(4)} KAS`,fee:ee}),X(null)},kt=()=>{S("SUSPENDED"),I({type:"SYSTEM",msg:"KILL-SWITCH activated â€” agent suspended. All pending actions cancelled.",fee:null}),B(a=>a.map(E=>E.status==="pending"?{...E,status:"rejected"}:E)),X(null)},se=O.filter(a=>a.status==="pending").length,Ze=parseFloat(D.filter(a=>a.fee).reduce((a,E)=>a+(E.fee||0),0).toFixed(4)),vn=Number((b==null?void 0:b.walletKas)||0),_n=Math.max(0,vn-Me-Ke),$e=ne&&!me&&(n==null?void 0:n.provider)!=="demo",It=Math.max(0,Math.ceil((Re-Date.now())/1e3)),Rt=`${Math.floor(It/60).toString().padStart(2,"0")}:${(It%60).toString().padStart(2,"0")}`,ye=(wt=U[0])==null?void 0:wt.dec,Ct=String((ye==null?void 0:ye.decision_source)||((Lt=U[0])==null?void 0:Lt.source)||"ai"),Tn=ge?Ne?"STREAM LIVE":vt>0?`STREAM RETRY ${vt}`:"STREAM DOWN":"STREAM OFF",jn=ge?Ne?s.ok:s.warn:s.dim,bn=[{k:"overview",l:"OVERVIEW"},{k:"intelligence",l:"INTELLIGENCE"},{k:"queue",l:`QUEUE${se>0?` (${se})`:""}`},{k:"treasury",l:"TREASURY"},{k:"wallet",l:"WALLET"},{k:"billing",l:"BILLING"},{k:"log",l:"LOG"},{k:"controls",l:"CONTROLS"}];return t.jsxs("div",{style:{maxWidth:1460,margin:"0 auto",padding:V?"14px 14px 22px":"22px 24px 34px"},children:[M&&t.jsx(St,{tx:M,wallet:n,onSign:An,onReject:yn}),t.jsxs("div",{style:{display:"flex",flexDirection:V?"column":"row",justifyContent:"space-between",alignItems:V?"stretch":"flex-start",marginBottom:16,gap:V?10:0},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{fontSize:11,color:s.dim,letterSpacing:"0.1em",...c,marginBottom:2},children:["FORGEOS / AGENT / ",e.name]}),t.jsx("div",{style:{fontSize:18,color:s.text,fontWeight:700,...c},children:e.name})]}),t.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap",justifyContent:V?"flex-start":"flex-end"},children:[t.jsx(R,{text:A,color:A==="RUNNING"?s.ok:A==="PAUSED"?s.warn:s.danger,dot:!0}),t.jsx(R,{text:G.toUpperCase(),color:s.accent}),t.jsx(R,{text:F?"LIVE EXEC ON":"LIVE EXEC OFF",color:F?s.ok:s.warn,dot:!0}),t.jsx(R,{text:nt?"ACCUMULATE-ONLY":"MULTI-ACTION",color:nt?s.ok:s.warn}),t.jsx(R,{text:((Ot=n==null?void 0:n.provider)==null?void 0:Ot.toUpperCase())||"WALLET",color:s.purple,dot:!0}),t.jsx(R,{text:ne?"DAG LIVE":"DAG OFFLINE",color:ne?s.ok:s.danger,dot:!0}),t.jsx(R,{text:Tn,color:jn,dot:!0})]})]}),!!me&&t.jsxs("div",{style:{background:s.dLow,border:`1px solid ${s.danger}40`,borderRadius:6,padding:"11px 16px",marginBottom:14,display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},children:[t.jsxs("span",{style:{fontSize:12,color:s.danger,...c},children:["Kaspa live feed error (poll fallback): ",me]}),t.jsx(T,{onClick:Se,disabled:H,size:"sm",variant:"ghost",children:H?"RECONNECTING...":"RECONNECT FEED"})]}),F&&!$e&&t.jsx("div",{style:{background:s.wLow,border:`1px solid ${s.warn}40`,borderRadius:6,padding:"11px 16px",marginBottom:14},children:t.jsx("span",{style:{fontSize:12,color:s.warn,...c},children:"Live execution is armed but not ready. Require DAG live feed and a real wallet provider (Kasware or Kaspium)."})}),se>0&&t.jsxs("div",{style:{background:s.wLow,border:`1px solid ${s.warn}40`,borderRadius:6,padding:"11px 16px",marginBottom:14,display:"flex",alignItems:V?"flex-start":"center",justifyContent:"space-between",flexDirection:V?"column":"row",gap:V?8:0},children:[t.jsxs("span",{style:{fontSize:12,color:s.warn,...c},children:["âš  ",se," transaction",se>1?"s":""," awaiting wallet signature"]}),t.jsx(T,{onClick:()=>v("queue"),size:"sm",variant:"warn",children:"VIEW QUEUE"})]}),t.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${s.border}`,marginBottom:18,overflowX:"auto"},children:bn.map(a=>t.jsx("button",{onClick:()=>v(a.k),style:{background:"none",border:"none",borderBottom:`2px solid ${g===a.k?s.accent:"transparent"}`,color:g===a.k?s.accent:s.dim,padding:"7px 14px",fontSize:11,cursor:"pointer",letterSpacing:"0.08em",...c,marginBottom:-1,whiteSpace:"nowrap",transition:"color 0.15s"},children:a.l},a.k))}),g==="overview"&&t.jsxs("div",{children:[t.jsx("div",{style:{display:"grid",gridTemplateColumns:gn,gap:10,marginBottom:12},children:[{l:"Wallet Balance",v:`${(b==null?void 0:b.walletKas)||e.capitalLimit} KAS`,s:te(n==null?void 0:n.address),c:s.accent},{l:"DAA Score",v:((Mt=(Dt=b==null?void 0:b.dag)==null?void 0:Dt.daaScore)==null?void 0:Mt.toLocaleString())||"â€”",s:"Kaspa DAG height",c:s.text},{l:"Pending Signatures",v:se,s:"In action queue",c:se>0?s.warn:s.dim},{l:"Total Protocol Fees",v:`${Ze} KAS`,s:`${(Ze*ae).toFixed(4)} KAS â†’ treasury`,c:s.text}].map(a=>t.jsxs(N,{p:14,children:[t.jsx(L,{children:a.l}),t.jsx("div",{style:{fontSize:18,color:a.c,fontWeight:700,...c,marginBottom:2},children:a.v}),t.jsx("div",{style:{fontSize:11,color:s.dim},children:a.s})]},a.l))}),t.jsxs(N,{p:16,style:{marginBottom:12},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,flexWrap:"wrap",marginBottom:8},children:[t.jsx(L,{children:"Mission Control"}),t.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[t.jsx(R,{text:J.toUpperCase(),color:so(J)}),t.jsx(R,{text:A,color:A==="RUNNING"?s.ok:s.warn,dot:!0}),t.jsx(R,{text:G.toUpperCase(),color:s.accent}),t.jsx(R,{text:F?"EXEC ARMED":"EXEC SAFE",color:F?s.ok:s.warn,dot:!0}),t.jsx(R,{text:`AUTO ${Rt}`,color:A==="RUNNING"?s.ok:s.dim}),t.jsx(R,{text:`SOURCE ${Ct.toUpperCase()}`,color:Ct==="fallback"?s.warn:s.ok}),t.jsx(R,{text:`QUOTA ${ke.used}/${ke.limit}`,color:ke.locked?s.danger:s.dim})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:we?"1fr":"1fr 1fr 1fr 1fr",gap:8,marginBottom:10},children:[t.jsxs("div",{style:{background:s.s2,border:`1px solid ${s.border}`,borderRadius:6,padding:"10px 12px"},children:[t.jsx("div",{style:{fontSize:10,color:s.dim,...c,marginBottom:4},children:"Spendable Balance"}),t.jsxs("div",{style:{fontSize:13,color:s.ok,fontWeight:700,...c},children:[_n.toFixed(4)," KAS"]})]}),t.jsxs("div",{style:{background:s.s2,border:`1px solid ${s.border}`,borderRadius:6,padding:"10px 12px"},children:[t.jsx("div",{style:{fontSize:10,color:s.dim,...c,marginBottom:4},children:"Last Decision"}),t.jsx("div",{style:{fontSize:13,color:s.text,fontWeight:700,...c},children:(ye==null?void 0:ye.action)||"â€”"})]}),t.jsxs("div",{style:{background:s.s2,border:`1px solid ${s.border}`,borderRadius:6,padding:"10px 12px"},children:[t.jsx("div",{style:{fontSize:10,color:s.dim,...c,marginBottom:4},children:"Capital / Cycle"}),t.jsxs("div",{style:{fontSize:13,color:s.text,fontWeight:700,...c},children:[e.capitalLimit," KAS"]})]}),t.jsxs("div",{style:{background:s.s2,border:`1px solid ${s.border}`,borderRadius:6,padding:"10px 12px"},children:[t.jsx("div",{style:{fontSize:10,color:s.dim,...c,marginBottom:4},children:"Execution Readiness"}),t.jsx("div",{style:{fontSize:13,color:$e?s.ok:s.warn,fontWeight:700,...c},children:$e?"READY":"NOT READY"})]})]}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[t.jsx(le,{href:`${ve}/addresses/${n==null?void 0:n.address}`,label:"WALLET EXPLORER â†—"}),t.jsx(le,{href:`${ve}/addresses/${Ge}`,label:"VAULT EXPLORER â†—"})]})]}),t.jsx("div",{style:{marginBottom:12},children:t.jsx(p.Suspense,{fallback:t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Performance"}),t.jsx("div",{style:{fontSize:12,color:s.dim},children:"Loading performance chart..."})]}),children:t.jsx(Zs,{decisions:U,kpiTarget:e.kpiTarget})})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:hn,gap:12},children:[t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Agent Configuration"}),[["Strategy","Momentum / On-Chain Flow"],["Risk",e.risk.toUpperCase()],["Capital / Cycle",`${e.capitalLimit} KAS`],["Exec Mode",G.toUpperCase()],["Auto-Approve â‰¤",`${_} KAS`],["Horizon",`${e.horizon} days`],["KPI Target",`${e.kpiTarget}% ROI`]].map(([a,E])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"7px 0",borderBottom:`1px solid ${s.border}`},children:[t.jsx("span",{style:{fontSize:12,color:s.dim,...c},children:a}),t.jsx("span",{style:{fontSize:12,color:s.text,...c},children:E})]},a))]}),t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Actions"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsx(T,{onClick:Le,disabled:Y||A!=="RUNNING",style:{padding:"10px 0"},children:Y?"PROCESSING...":"RUN QUANT CYCLE"}),t.jsx(T,{onClick:Se,disabled:H,variant:"ghost",style:{padding:"9px 0"},children:H?"FETCHING DAG...":ne?"REFRESH KASPA DATA":ge?"RECONNECT STREAM/DATA":"RECONNECT KASPA FEED"}),t.jsx(T,{onClick:()=>Ie(a=>!a),variant:F?"warn":"primary",style:{padding:"9px 0"},children:F?"DISARM LIVE EXECUTION":"ARM LIVE EXECUTION"}),t.jsxs(T,{onClick:()=>v("queue"),variant:"ghost",style:{padding:"9px 0"},children:["ACTION QUEUE ",se>0?`(${se})`:""]}),ke.locked&&t.jsx(T,{onClick:()=>{Ve?window.open(Ve,"_blank","noopener,noreferrer"):v("billing")},variant:"warn",style:{padding:"9px 0"},children:"UPGRADE TO CONTINUE"}),t.jsx(T,{onClick:()=>S(a=>a==="RUNNING"?"PAUSED":"RUNNING"),variant:"ghost",style:{padding:"9px 0"},children:A==="RUNNING"?"PAUSE":"RESUME"}),t.jsx(T,{onClick:kt,variant:"danger",style:{padding:"9px 0"},children:"KILL-SWITCH"})]})]})]})]}),g==="intelligence"&&t.jsx(p.Suspense,{fallback:t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Intelligence"}),t.jsx("div",{style:{fontSize:12,color:s.dim},children:"Loading intelligence panel..."})]}),children:t.jsx(eo,{decisions:U,loading:Y,onRun:Le})}),g==="queue"&&t.jsx(qs,{queue:O,wallet:n,onSign:Sn,onReject:Nt}),g==="treasury"&&t.jsx(p.Suspense,{fallback:t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Treasury"}),t.jsx("div",{style:{fontSize:12,color:s.dim},children:"Loading treasury panel..."})]}),children:t.jsx(to,{log:D,agentCapital:e.capitalLimit})}),g==="wallet"&&t.jsx(Js,{agent:e,wallet:n}),g==="billing"&&t.jsx(Qs,{usage:ke}),g==="log"&&t.jsxs(N,{p:0,children:[t.jsxs("div",{style:{padding:"12px 18px",borderBottom:`1px solid ${s.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{style:{fontSize:11,color:s.dim,...c},children:[D.length," entries Â· ",Ze," KAS fees"]}),t.jsx(T,{onClick:Le,disabled:Y||A!=="RUNNING",size:"sm",children:Y?"...":"RUN CYCLE"})]}),t.jsx("div",{style:{maxHeight:520,overflowY:"auto"},children:D.map((a,E)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:V?"74px 58px 1fr":"92px 72px 1fr 80px",gap:10,padding:"8px 18px",borderBottom:`1px solid ${s.border}`,alignItems:"center"},children:[t.jsx("span",{style:{fontSize:11,color:s.dim,...c},children:tn(a.ts)}),t.jsx("span",{style:{fontSize:11,color:Os[a.type]||s.dim,fontWeight:700,...c},children:a.type}),t.jsx("span",{style:{fontSize:12,color:s.text,...c,lineHeight:1.4},children:a.msg}),!V&&t.jsx("span",{style:{fontSize:11,color:s.dim,textAlign:"right",...c},children:a.fee!=null?`${a.fee} KAS`:"â€”"})]},E))})]}),g==="controls"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:En,gap:14},children:[t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Execution Mode"}),ut.map(a=>{const E=G===a.v;return t.jsxs("div",{onClick:()=>h(a.v),style:{padding:"12px 14px",borderRadius:4,marginBottom:8,cursor:"pointer",border:`1px solid ${E?s.accent:s.border}`,background:E?s.aLow:s.s2,transition:"all 0.15s"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:3},children:[t.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:E?s.accent:s.muted,flexShrink:0}}),t.jsx("span",{style:{fontSize:12,color:E?s.accent:s.text,fontWeight:700,...c},children:a.l})]}),t.jsx("div",{style:{fontSize:11,color:s.dim,marginLeft:20},children:a.desc})]},a.v)})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[t.jsxs(N,{p:18,children:[t.jsx(L,{children:"Agent Controls"}),t.jsxs("div",{style:{fontSize:11,color:s.dim,...c,marginBottom:10},children:["Auto cycle cadence: every ",Ye,"s Â· Next cycle in ",Rt]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsx(T,{onClick:()=>S(a=>a==="RUNNING"?"PAUSED":"RUNNING"),variant:"ghost",style:{padding:"10px 0"},children:A==="RUNNING"?"PAUSE AGENT":"RESUME AGENT"}),t.jsx(T,{onClick:()=>Ie(a=>!a),variant:F?"warn":"primary",style:{padding:"10px 0"},children:F?"DISARM LIVE EXECUTION":"ARM LIVE EXECUTION"}),t.jsx(T,{onClick:()=>v("wallet"),variant:"ghost",style:{padding:"10px 0"},children:"MANAGE WALLET"}),t.jsx(T,{onClick:kt,variant:"danger",style:{padding:"10px 0"},children:"ACTIVATE KILL-SWITCH"})]})]}),t.jsxs(N,{p:18,children:[t.jsxs(L,{children:["Active Risk Limits â€” ",e.risk.toUpperCase()]}),[["Max Single Exposure",e.risk==="low"?"5%":e.risk==="medium"?"10%":"20%",s.warn],["Drawdown Halt",e.risk==="low"?"-8%":e.risk==="medium"?"-15%":"-25%",s.danger],["Confidence Floor","0.75",s.dim],["Kelly Cap",e.risk==="low"?"10%":e.risk==="medium"?"20%":"40%",s.warn],["Auto-Approve â‰¤",`${_} KAS`,s.accent]].map(([a,E,x])=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"7px 0",borderBottom:`1px solid ${s.border}`},children:[t.jsx("span",{style:{fontSize:12,color:s.dim,...c},children:a}),t.jsx("span",{style:{fontSize:12,color:x,fontWeight:700,...c},children:E})]},a))]})]})]})]})}function so(e){return String(e||"").toLowerCase().includes("mainnet")?s.warn:s.ok}function oo(){const[e,n]=p.useState(null),[o,i]=p.useState("create"),[r,m]=p.useState(null),[d,l]=p.useState(!1),[u,f]=p.useState(typeof window<"u"?window.innerWidth:1280),y=S=>{n(S)},k=S=>{m(S),i("dashboard")},C=z==="mainnet",g=p.useMemo(()=>Mn.filter(S=>S.id==="mainnet"||S.id.startsWith("testnet")),[]),v=u<860,A=S=>{if(!(typeof window>"u"||d||S===z||(e||r)&&!window.confirm("Switching networks will reset the current wallet session and agent state. Continue?"))){l(!0);try{window.localStorage.setItem("forgeos.network",S);const $=new URL(window.location.href);$.searchParams.set("network",S),window.location.assign($.toString())}catch{l(!1)}}};return p.useEffect(()=>{if(typeof window>"u")return;const S=()=>f(window.innerWidth);return window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]),e?t.jsxs("div",{className:"forge-shell",style:{color:s.text},children:[t.jsx(cn,{}),t.jsxs("div",{className:"forge-content",style:{minHeight:"100vh"},children:[t.jsxs("div",{className:"forge-topbar",style:{borderBottom:`1px solid ${s.border}`,padding:"12px clamp(14px, 2vw, 24px)",display:"flex",flexDirection:v?"column":"row",alignItems:v?"stretch":"center",justifyContent:"space-between",gap:v?10:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,justifyContent:v?"space-between":"flex-start"},children:[t.jsxs("div",{style:{fontSize:14,fontWeight:700,letterSpacing:"0.14em",...c},children:[t.jsx("span",{style:{color:s.accent},children:"FORGE"}),t.jsx("span",{style:{color:s.text},children:"OS"})]}),t.jsx("div",{style:{width:1,height:14,background:s.border}}),t.jsx("div",{style:{fontSize:10,color:s.dim,letterSpacing:"0.08em",...c},children:"AI-NATIVE FINANCIAL OS Â· KASPA"})]}),t.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap",justifyContent:v?"flex-start":"flex-end"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,border:`1px solid ${C?s.warn:s.ok}50`,background:C?s.wLow:s.oLow,borderRadius:6,padding:"4px 6px"},children:[t.jsx("span",{style:{fontSize:10,color:C?s.warn:s.ok,letterSpacing:"0.08em",...c},children:J.toUpperCase()}),t.jsx("select",{value:Ue.id,onChange:S=>A(S.target.value),disabled:d,style:{background:"transparent",color:s.text,border:`1px solid ${s.border}`,borderRadius:4,padding:"4px 8px",fontSize:10,letterSpacing:"0.05em",...c},title:"Switch runtime Kaspa network profile",children:g.map(S=>t.jsx("option",{value:S.id,style:{background:s.s1,color:s.text},children:S.label},S.id))})]}),!r&&t.jsx("button",{onClick:()=>i("create"),style:{background:o==="create"?s.s2:"none",border:`1px solid ${o==="create"?s.border:"transparent"}`,color:o==="create"?s.text:s.dim,padding:"5px 14px",borderRadius:4,fontSize:11,cursor:"pointer",...c},children:"NEW AGENT"}),r&&t.jsx("button",{onClick:()=>i("dashboard"),style:{background:o==="dashboard"?s.s2:"none",border:`1px solid ${o==="dashboard"?s.accent:"transparent"}`,color:o==="dashboard"?s.accent:s.dim,padding:"5px 14px",borderRadius:4,fontSize:11,cursor:"pointer",...c},children:r.name}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"5px 12px",border:`1px solid ${s.border}`,borderRadius:4},children:[t.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:(e==null?void 0:e.provider)==="demo"?s.warn:s.ok}}),t.jsx("span",{style:{fontSize:10,color:s.dim,letterSpacing:"0.08em",...c},children:te(e==null?void 0:e.address)})]}),t.jsx(T,{onClick:()=>{n(null),m(null),i("create")},variant:"ghost",size:"sm",children:"DISCONNECT"})]})]}),o==="create"?t.jsx(fs,{wallet:e,onComplete:k}):t.jsx(no,{agent:r,wallet:e})]})]}):t.jsx(cs,{onConnect:y})}class ro extends Jt.Component{constructor(o){super(o);tt(this,"resetApp",()=>{if(typeof window>"u")return;const o=new URL(window.location.href);o.searchParams.set("_recover",Date.now().toString()),window.location.replace(o.toString())});tt(this,"clearLocalStateAndReload",()=>{if(!(typeof window>"u")){try{const o=Object.keys(window.localStorage);for(const i of o)i.startsWith("forgeos.")&&window.localStorage.removeItem(i)}catch{}this.resetApp()}});this.state={hasError:!1,message:""}}static getDerivedStateFromError(o){return{hasError:!0,message:(o==null?void 0:o.message)||"Unknown runtime error"}}componentDidCatch(o){console.error("ForgeOS runtime crash:",o)}render(){return this.state.hasError?t.jsxs("div",{style:{minHeight:"100vh",background:"#0a0a0a",color:"#f5f5f5",padding:24,fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace"},children:[t.jsx("div",{style:{fontSize:16,fontWeight:700,marginBottom:8},children:"ForgeOS runtime error"}),t.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:12},children:"The app encountered an unexpected error. Reload, then check console/network config if this continues."}),t.jsx("pre",{style:{whiteSpace:"pre-wrap",background:"#111",border:"1px solid #222",padding:12,borderRadius:6},children:this.state.message}),t.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[t.jsx("button",{type:"button",onClick:this.resetApp,style:{border:"1px solid #3a4e66",background:"#111826",color:"#d7e4f7",borderRadius:8,padding:"8px 12px",cursor:"pointer"},children:"Retry App"}),t.jsx("button",{type:"button",onClick:this.clearLocalStateAndReload,style:{border:"1px solid #5a3340",background:"#241018",color:"#ffd5dc",borderRadius:8,padding:"8px 12px",cursor:"pointer"},children:"Clear ForgeOS Session"})]})]}):this.props.children}}window.__FORGEOS_BOOTED__=!0;document.documentElement.setAttribute("data-forgeos-booted","1");window.__FORGEOS_RENDERED__||(window.__FORGEOS_RENDERED__=!0,ct.createRoot(document.getElementById("root")).render(t.jsx(Jt.StrictMode,{children:t.jsx(ro,{children:t.jsx(oo,{})})})));export{lt as A,R as B,N as C,le as E,L,ae as T,s as a,T as b,uo as c,tn as d,Pt as e,lo as f,ve as g,Os as h,t as j,c as m};
